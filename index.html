<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ Rational Numbers Game - Form 1 KSSM</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .game-layout {
            display: flex;
            gap: 30px;
            align-items: flex-start;
        }

        .game-main {
            flex: 1;
            min-width: 0;
        }

        .live-leaderboard {
            width: 350px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 20px;
            color: white;
            position: sticky;
            top: 20px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .live-leaderboard h3 {
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .mini-leaderboard-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 12px;
            margin: 8px 0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            backdrop-filter: blur(10px);
        }

        .mini-leaderboard-item.top1 {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #333;
            font-weight: bold;
            border: 2px solid #ff9800;
        }

        .mini-leaderboard-item.top2 {
            background: linear-gradient(135deg, #c0c0c0 0%, #e8e8e8 100%);
            color: #333;
            font-weight: bold;
        }

        .mini-leaderboard-item.top3 {
            background: linear-gradient(135deg, #cd7f32 0%, #e0a869 100%);
            color: #333;
            font-weight: bold;
        }

        .mini-leaderboard-item.current-player {
            border: 3px solid #ffc107;
            animation: glow 1s infinite;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 10px rgba(255, 193, 7, 0.5); }
            50% { box-shadow: 0 0 20px rgba(255, 193, 7, 0.8); }
        }

        .mini-rank {
            font-size: 1.2em;
            font-weight: bold;
            width: 35px;
        }

        .mini-name {
            flex: 1;
            font-size: 0.9em;
        }

        .mini-score {
            font-weight: bold;
            font-size: 1.1em;
        }

        .answer-history {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid rgba(255, 255, 255, 0.3);
        }

        .answer-history h4 {
            margin-bottom: 10px;
            text-align: center;
            font-size: 1.2em;
        }

        .answer-markers {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
        }

        .answer-marker {
            width: 32px;
            height: 32px;
            line-height: 32px;
            text-align: center;
            border-radius: 5px;
            font-weight: bold;
            font-size: 0.85em;
        }

        .answer-marker.correct {
            background: #28a745;
            color: white;
        }

        .answer-marker.wrong {
            background: #dc3545;
            color: white;
        }

        .answer-marker.timeout {
            background: #6c757d;
            color: white;
        }

        .answer-marker.pending {
            background: rgba(255, 255, 255, 0.3);
            color: white;
            border: 2px dashed white;
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .stats-bar {
            display: flex;
            justify-content: space-around;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .stat {
            text-align: center;
            padding: 10px;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            display: block;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .level-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 5px solid #667eea;
        }

        .level-title {
            font-size: 1.5em;
            color: #667eea;
            margin-bottom: 5px;
        }

        .question-card {
            background: #fff;
            border: 3px solid #667eea;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .question-number {
            color: #764ba2;
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 15px;
        }

        .question-text {
            font-size: 1.8em;
            text-align: center;
            margin: 20px 0;
            color: #333;
            font-weight: bold;
            line-height: 1.5;
        }

        .input-area {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .answer-label {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
        }

        input[type="number"], input[type="text"] {
            font-size: 1.8em;
            padding: 15px;
            border: 3px solid #667eea;
            border-radius: 10px;
            width: 200px;
            text-align: center;
            font-weight: bold;
        }

        input:focus {
            outline: none;
            border-color: #764ba2;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }

        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            padding: 15px 30px;
            font-size: 1.1em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .btn-submit {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }

        .btn-hint {
            background: #ffc107;
            color: #333;
        }

        .btn-hint:hover {
            background: #ffb300;
            transform: translateY(-2px);
        }

        .btn-next {
            background: #28a745;
            color: white;
        }

        .btn-next:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .feedback {
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
            font-size: 1.2em;
            text-align: center;
            font-weight: bold;
            display: none;
        }

        .feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 2px solid #28a745;
            display: block;
        }

        .feedback.wrong {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #dc3545;
            display: block;
        }

        .hint-box {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            display: none;
        }

        .hint-box.show {
            display: block;
        }

        .solution-box {
            background: #e7f3ff;
            border: 2px solid #2196F3;
            border-radius: 10px;
            padding: 20px;
            margin-top: 15px;
            display: none;
        }

        .solution-box.show {
            display: block;
        }

        .solution-title {
            font-weight: bold;
            color: #2196F3;
            font-size: 1.2em;
            margin-bottom: 15px;
        }

        .solution-methods {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .method {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #2196F3;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .method.visible {
            opacity: 1;
        }

        .method-title {
            font-weight: bold;
            color: #764ba2;
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .solution-steps {
            font-size: 1.05em;
            line-height: 1.8;
        }

        .solution-step {
            margin: 5px 0;
            padding-left: 15px;
            opacity: 0;
            transform: translateX(-20px);
            transition: all 0.5s ease;
        }

        .solution-step.visible {
            opacity: 1;
            transform: translateX(0);
        }

        .solution-step.speaking {
            background: #fff3cd;
            padding: 8px;
            margin: 8px 0;
            border-radius: 5px;
            font-weight: bold;
            border-left: 4px solid #ffc107;
            animation: highlight 0.5s ease;
        }

        @keyframes highlight {
            0% { background: #fff; }
            50% { background: #ffeb3b; }
            100% { background: #fff3cd; }
        }

        .audio-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .btn-audio {
            background: #ff6b6b;
            color: white;
            padding: 12px 25px;
            font-size: 1em;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .btn-audio:hover {
            background: #ee5a52;
            transform: translateY(-2px);
        }

        .btn-audio.playing {
            background: #51cf66;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .speed-control {
            display: flex;
            align-items: center;
            gap: 10px;
            background: white;
            padding: 10px 15px;
            border-radius: 8px;
            border: 2px solid #667eea;
        }

        .speed-control label {
            font-weight: bold;
            color: #667eea;
        }

        .speed-control select {
            padding: 5px 10px;
            border: 2px solid #667eea;
            border-radius: 5px;
            font-size: 1em;
            cursor: pointer;
        }

        .progress-bar {
            background: #e9ecef;
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .progress-fill {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .celebration {
            text-align: center;
            padding: 40px;
        }

        .celebration h2 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 20px;
        }

        .final-score {
            font-size: 3em;
            color: #764ba2;
            font-weight: bold;
            margin: 20px 0;
        }

        .btn-restart {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 40px;
            font-size: 1.3em;
            margin-top: 20px;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .bounce {
            animation: bounce 0.5s;
        }

        .start-container {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            color: white;
            margin: 20px 0;
        }

        .start-icon {
            font-size: 5em;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }

        .start-title {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .start-subtitle {
            font-size: 1.2em;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        .start-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .info-box {
            background: rgba(255, 255, 255, 0.2);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .info-icon {
            font-size: 2.5em;
        }

        .info-text {
            text-align: left;
            font-size: 0.9em;
        }

        .info-text strong {
            font-size: 1.2em;
            display: block;
            margin-bottom: 5px;
        }

        .btn-start {
            background: white;
            color: #667eea;
            padding: 20px 50px;
            font-size: 1.5em;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }

        .btn-start:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }

        .start-note {
            margin-top: 30px;
            font-size: 1.1em;
            padding: 15px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .btn-end-game {
            background: #dc3545;
            color: white;
            padding: 10px 20px;
            font-size: 1em;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        .btn-end-game:hover {
            background: #c82333;
        }

        #timer {
            transition: all 0.3s;
        }

        #timer.warning {
            color: #ffc107;
            animation: pulse 0.5s infinite;
        }

        #timer.danger {
            color: #dc3545;
            animation: pulse 0.3s infinite;
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            padding: 15px 20px;
            margin: 10px 0;
            border-radius: 10px;
            font-size: 1.1em;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .leaderboard-item.top1 {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            font-size: 1.3em;
            padding: 20px;
            border: 3px solid #ff9800;
        }

        .leaderboard-item.top2 {
            background: linear-gradient(135deg, #c0c0c0 0%, #e8e8e8 100%);
            font-size: 1.2em;
            padding: 18px;
        }

        .leaderboard-item.top3 {
            background: linear-gradient(135deg, #cd7f32 0%, #e0a869 100%);
            font-size: 1.15em;
            padding: 17px;
        }

        .leaderboard-rank {
            font-weight: bold;
            font-size: 1.5em;
            width: 50px;
        }

        .leaderboard-name {
            flex: 1;
            font-weight: bold;
        }

        .leaderboard-score {
            font-weight: bold;
            font-size: 1.2em;
            margin: 0 15px;
        }

        .leaderboard-time {
            color: #666;
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            h1 {
                font-size: 1.8em;
            }
            
            .question-text {
                font-size: 1.5em;
            }
            
            input[type="number"], input[type="text"] {
                width: 150px;
                font-size: 1.5em;
            }

            .audio-controls {
                flex-direction: column;
            }
            
            .btn-audio {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ Rational Numbers Game</h1>
        <div class="subtitle">Malaysia Form 1 KSSM Mathematics - Chapter 1</div>

        <!-- Level Selection Screen -->
        <div id="levelSelectScreen" style="display: block;">
            <div class="start-container">
                <div class="start-icon">üî¢</div>
                <h2 class="start-title">Rational Numbers Challenge</h2>
                <div class="start-subtitle">Chapter 1: Two-Level Mastery System</div>
                
                <div style="margin: 30px 0; padding: 20px; background: rgba(255,255,255,0.2); border-radius: 15px;">
                    <label style="font-size: 1.3em; font-weight: bold; display: block; margin-bottom: 15px;">üë§ Select Your Name:</label>
                    <select id="studentSelect" style="width: 100%; padding: 15px; font-size: 1.2em; border-radius: 10px; border: 3px solid white; font-weight: bold;">
                        <option value="">-- Choose Student --</option>
                        <option value="CHOW YOU CHEN Âë®ÂÆ•Ëæ∞">CHOW YOU CHEN Âë®ÂÆ•Ëæ∞</option>
                        <option value="CONSTANCE SIM JAY YING Ê≤àÊ¥ÅËéπ">CONSTANCE SIM JAY YING Ê≤àÊ¥ÅËéπ</option>
                        <option value="IAN LEE JUN WEI Êùé‰øäÊöê">IAN LEE JUN WEI Êùé‰øäÊöê</option>
                        <option value="LIM YOU JAY Êûó‰ΩëÁàµ">LIM YOU JAY Êûó‰ΩëÁàµ</option>
                        <option value="TAN YI XIN ÈôàÊÄ°ÂøÉ">TAN YI XIN ÈôàÊÄ°ÂøÉ</option>
                        <option value="MAKIYO LIM SHIN EN ÊûóËäØÊÅ©">MAKIYO LIM SHIN EN ÊûóËäØÊÅ©</option>
                        <option value="FELICIA YEOH KE NING Êù®ÁèÇÂÆÅ">FELICIA YEOH KE NING Êù®ÁèÇÂÆÅ</option>
                        <option value="LEE MIN HAO ÊùéÊóªÊòä">LEE MIN HAO ÊùéÊóªÊòä</option>
                        <option value="TAN WEN JUN ÈôàÊñá‰øä">TAN WEN JUN ÈôàÊñá‰øä</option>
                        <option value="JANICE OOI XIN YUE ÈªÑÊ¨£ÊÇ¶">JANICE OOI XIN YUE ÈªÑÊ¨£ÊÇ¶</option>
                        <option value="HO JACK HAOW ‰ΩïÊù∞Ë±™">HO JACK HAOW ‰ΩïÊù∞Ë±™</option>
                        <option value="FOO JIA YEE Á¨¶ÂòâËØí">FOO JIA YEE Á¨¶ÂòâËØí</option>
                        <option value="CHLOE KUNG KE YEE Ê±üÂù∑Ë∞ï">CHLOE KUNG KE YEE Ê±üÂù∑Ë∞ï</option>
                        <option value="AIDEN TAN XU YUAN ÈôàÁª≠ÂÖÉ">AIDEN TAN XU YUAN ÈôàÁª≠ÂÖÉ</option>
                        <option value="KEE JUN YI Á∫™È™èÈÄ∏">KEE JUN YI Á∫™È™èÈÄ∏</option>
                        <option value="UNG JING ERN Ê¥™ÈùñÊÅ©">UNG JING ERN Ê¥™ÈùñÊÅ©</option>
                        <option value="TEOH KHAI JUN Âº†ÊÅ∫Âùá">TEOH KHAI JUN Âº†ÊÅ∫Âùá</option>
                    </select>
                </div>

                <!-- Level Cards -->
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin: 30px 0;">
                    <!-- Level 1 Card -->
                    <div id="level1Card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 25px; border-radius: 15px; color: white; cursor: pointer; transition: transform 0.3s;" onclick="selectLevel(1)">
                        <div style="font-size: 2em; margin-bottom: 10px;">‚≠ê</div>
                        <h3 style="margin: 0 0 10px 0; font-size: 1.5em;">Level 1: Basic</h3>
                        <p style="margin: 0 0 15px 0; opacity: 0.9;">Integer Operations</p>
                        <div style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: 8px; margin-bottom: 10px;">
                            <div style="font-size: 0.9em; opacity: 0.9;">50 Questions</div>
                            <div style="font-size: 0.9em; opacity: 0.9;">Pass: 40/50 (80%)</div>
                        </div>
                        <div id="level1Status" style="font-weight: bold; font-size: 1.1em;">
                            ‚úÖ Always Available
                        </div>
                        <div id="level1BestScore" style="margin-top: 10px; font-size: 0.9em; opacity: 0.8;">
                            <!-- Best score will be shown here -->
                        </div>
                    </div>

                    <!-- Level 2 Card -->
                    <div id="level2Card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 25px; border-radius: 15px; color: white; position: relative; transition: transform 0.3s;">
                        <div id="level2Lock" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); border-radius: 15px; display: flex; flex-direction: column; align-items: center; justify-content: center; backdrop-filter: blur(3px);">
                            <div style="font-size: 3em; margin-bottom: 15px;">üîí</div>
                            <div style="font-size: 1.2em; font-weight: bold;">Locked</div>
                            <div style="font-size: 0.9em; opacity: 0.9; margin-top: 10px; text-align: center; padding: 0 20px;">
                                Pass Level 1 to unlock
                            </div>
                        </div>
                        <div onclick="selectLevel(2)" style="cursor: pointer;">
                            <div style="font-size: 2em; margin-bottom: 10px;">‚≠ê‚≠ê</div>
                            <h3 style="margin: 0 0 10px 0; font-size: 1.5em;">Level 2: Advanced</h3>
                            <p style="margin: 0 0 15px 0; opacity: 0.9;">Fractions & Decimals</p>
                            <div style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: 8px; margin-bottom: 10px;">
                                <div style="font-size: 0.9em; opacity: 0.9;">50 Questions</div>
                                <div style="font-size: 0.9em; opacity: 0.9;">Pass: 40/50 (80%)</div>
                            </div>
                            <div id="level2Status" style="font-weight: bold; font-size: 1.1em;">
                                <!-- Status will be shown here -->
                            </div>
                            <div id="level2BestScore" style="margin-top: 10px; font-size: 0.9em; opacity: 0.8;">
                                <!-- Best score will be shown here -->
                            </div>
                        </div>
                    </div>

                    <!-- Level 3 Card -->
                    <div id="level3Card" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); padding: 25px; border-radius: 15px; color: white; position: relative; transition: transform 0.3s;">
                        <div id="level3Lock" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); border-radius: 15px; display: flex; flex-direction: column; align-items: center; justify-content: center; backdrop-filter: blur(3px);">
                            <div style="font-size: 3em; margin-bottom: 15px;">üîí</div>
                            <div style="font-size: 1.2em; font-weight: bold;">Locked</div>
                            <div style="font-size: 0.9em; opacity: 0.9; margin-top: 10px; text-align: center; padding: 0 20px;">
                                Pass Level 2 to unlock
                            </div>
                        </div>
                        <div onclick="selectLevel(3)" style="cursor: pointer;">
                            <div style="font-size: 2em; margin-bottom: 10px;">‚≠ê‚≠ê‚≠ê</div>
                            <h3 style="margin: 0 0 10px 0; font-size: 1.5em;">Level 3: Master</h3>
                            <p style="margin: 0 0 15px 0; opacity: 0.9;">Word Problems</p>
                            <div style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: 8px; margin-bottom: 10px;">
                                <div style="font-size: 0.9em; opacity: 0.9;">50 Questions</div>
                                <div style="font-size: 0.9em; opacity: 0.9;">Pass: 40/50 (80%)</div>
                                <div style="font-size: 0.85em; opacity: 0.9; margin-top: 3px;">‚≠ê 6 points each</div>
                            </div>
                            <div id="level3Status" style="font-weight: bold; font-size: 1.1em;">
                                <!-- Status will be shown here -->
                            </div>
                            <div id="level3BestScore" style="margin-top: 10px; font-size: 0.9em; opacity: 0.8;">
                                <!-- Best score will be shown here -->
                            </div>
                        </div>
                    </div>
                </div>

                <div style="background: rgba(255,193,7,0.2); padding: 20px; border-radius: 10px; border-left: 5px solid #ffc107; margin: 20px 0;">
                    <strong>üéØ Goal:</strong> Pass all 3 levels to graduate Chapter 1!<br>
                    <strong>üìä Passing Score:</strong> 40 out of 50 correct answers (80%) per level<br>
                    <strong>üìö Chapter 1:</strong> Rational Numbers (Integers, Fractions, Decimals, Mixed Operations)
                </div>

                <button class="btn-start" onclick="showLeaderboard()" style="background: #ffc107; color: #333;">
                    üèÜ View Leaderboard
                </button>
            </div>
        </div>

        <div id="startScreen" style="display: none;">
            <div class="start-container">
                <div class="start-icon" id="startLevelIcon">‚≠ê</div>
                <h2 class="start-title" id="startLevelTitle">Level 1: Basic</h2>
                <div class="start-subtitle" id="startLevelSubtitle">Integer Operations</div>
                
                <div class="start-info">
                    <div class="info-box">
                        <div class="info-icon">üìù</div>
                        <div class="info-text">
                            <strong>50 Questions</strong><br>
                            <span id="startQuestionTypes">5 Types of Problems</span>
                        </div>
                    </div>
                    <div class="info-box">
                        <div class="info-icon">‚è±Ô∏è</div>
                        <div class="info-text">
                            <strong>Timed Challenge</strong><br>
                            <span id="startTimeInfo">25-45 seconds per question</span>
                        </div>
                    </div>
                    <div class="info-box">
                        <div class="info-icon">üéØ</div>
                        <div class="info-text">
                            <strong>Pass Requirement</strong><br>
                            40/50 Correct (80%)
                        </div>
                    </div>
                    <div class="info-box">
                        <div class="info-icon">üîä</div>
                        <div class="info-text">
                            <strong>Voice Teacher</strong><br>
                            Step-by-step explanations
                        </div>
                    </div>
                </div>

                <button class="btn-start" onclick="startGame()">
                    üöÄ Start Game
                </button>

                <button class="btn-start" onclick="backToLevelSelect()" style="background: #6c757d; margin-top: 15px;">
                    ‚Üê Back to Level Select
                </button>

                <div class="start-note">
                    üí° Tip: Questions are randomized each time you play!
                </div>
            </div>
        </div>

        <div id="gameArea" style="display: none;">
            <div class="stats-bar">
            <div class="stat">
                <span class="stat-value" id="currentLevel">1</span>
                <span class="stat-label">Level</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="score">0</span>
                <span class="stat-label">Score</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="questionNum">1/50</span>
                <span class="stat-label">Question</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="correct">0</span>
                <span class="stat-label">Correct</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="timer">25</span>
                <span class="stat-label">Time Left</span>
            </div>
            <div class="stat">
                <button class="btn-end-game" onclick="restartToMenu()">üîÑ Restart</button>
            </div>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 2%;">2%</div>
        </div>
            <div class="game-layout">
                <div class="game-main">
                    <div class="level-info">
                        <div class="level-title" id="levelTitle">‚≠ê Level 1: Integers Addition</div>
                        <div id="levelDesc">Add positive and negative integers | +5 correct, -3 wrong, -6 timeout</div>
                    </div>

                    <div class="question-card">
                <div class="question-number" id="questionLabel">Question 1</div>
                <div class="question-text" id="questionText">5 + (-3) = ?</div>
                
                <div class="input-area">
                    <span class="answer-label">Answer:</span>
                    <input type="text" id="answerInput" placeholder="?" autofocus>
                </div>

                <div class="button-group">
                    <button class="btn-submit" id="submitBtn" onclick="checkAnswer()">‚úì Submit Answer</button>
                    <button class="btn-hint" onclick="showHint()">üí° Hint</button>
                    <button class="btn-next" id="nextBtn" onclick="nextQuestion()" style="display: none;">‚û°Ô∏è Next Question</button>
                </div>

                <div class="hint-box" id="hintBox"></div>
                <div class="solution-box" id="solutionBox">
                    <div class="solution-title">üìù Working Steps (Multiple Methods):</div>
                    <div class="audio-controls">
                        <button class="btn-audio" id="playBtn" onclick="speakSolution()">
                            üîä Read Solution
                        </button>
                        <button class="btn-audio" id="stopBtn" onclick="stopSpeaking()" style="display: none;">
                            ‚èπÔ∏è Stop
                        </button>
                        <div class="speed-control">
                            <label>Speed:</label>
                            <select id="speedControl" onchange="changeSpeed()">
                                <option value="0.7">Slow</option>
                                <option value="1.0" selected>Normal</option>
                                <option value="1.3">Fast</option>
                            </select>
                        </div>
                    </div>
                    <div class="solution-methods" id="solutionMethods"></div>
                </div>
                <div class="feedback" id="feedback"></div>
            </div>
        </div>

        <div class="live-leaderboard">
            <h3>üèÜ Live Leaderboard</h3>
            <div id="liveLeaderboardContent">
                <div style="text-align: center; padding: 20px; opacity: 0.7;">
                    Loading...
                </div>
            </div>
            
            <div class="answer-history">
                <h4>üìä Your Progress</h4>
                <div class="answer-markers" id="answerMarkers">
                    <!-- Answer markers will be inserted here -->
                </div>
            </div>

            <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid rgba(255, 255, 255, 0.3);">
                <button id="clearLeaderboardBtnLive" style="width: 100%; padding: 15px; background: #dc3545; color: white; border: none; border-radius: 10px; font-size: 1.1em; font-weight: bold; cursor: pointer;">
                    üóëÔ∏è Clear Leaderboard
                </button>
            </div>
        </div>
    </div>
</div>

        <div id="celebrationArea" style="display: none;">
            <div class="celebration">
                <h2 id="celebrationTitle">üéâ Level Complete! üéâ</h2>
                <div style="font-size: 1.3em; margin: 10px 0;"><strong id="studentNameDisplay"></strong></div>
                <div id="celebrationMessage">You completed all 50 questions!</div>
                <div class="final-score" id="finalScore">85/100</div>
                <div style="font-size: 1.2em; margin: 10px 0;">‚è±Ô∏è Total Time: <strong id="totalTimeDisplay">0:00</strong></div>
                <div id="performance"></div>
                
                <!-- Pass/Fail Status -->
                <div id="passFailStatus" style="margin: 30px 0; padding: 25px; border-radius: 15px; font-size: 1.2em;">
                    <!-- Will be filled by JavaScript -->
                </div>
                
                <div id="celebrationButtons">
                    <button class="btn-restart" onclick="restartGame()">üîÑ Play This Level Again</button>
                    <button class="btn-restart" onclick="backToLevelSelect()" style="background: #667eea; margin-left: 10px;">üìö Back to Level Select</button>
                    <button class="btn-restart" onclick="showLeaderboard()" style="background: #ffc107; margin-left: 10px;">üèÜ View Leaderboard</button>
                </div>
            </div>
        </div>

        <!-- Graduation Certificate Screen -->
        <div id="graduationScreen" style="display: none;">
            <div class="start-container" style="max-width: 800px;">
                <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 50px; border-radius: 20px; color: white; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
                    <div style="font-size: 4em; margin-bottom: 20px;">üèÜ</div>
                    <h1 style="font-size: 2.5em; margin: 0 0 10px 0;">CONGRATULATIONS!</h1>
                    <h2 style="font-size: 2em; margin: 0 0 30px 0; opacity: 0.9;">Chapter 1 Graduated!</h2>
                    
                    <div style="background: rgba(255,255,255,0.2); padding: 30px; border-radius: 15px; margin: 30px 0;">
                        <div style="font-size: 1.8em; font-weight: bold; margin-bottom: 20px;" id="gradStudentName">Student Name</div>
                        
                        <div style="font-size: 1.2em; line-height: 2;">
                            <div>üìö <strong>Chapter:</strong> Rational Numbers</div>
                            <div>‚≠ê <strong>Level 1 Score:</strong> <span id="gradLevel1Score">--/100</span></div>
                            <div>‚≠ê‚≠ê <strong>Level 2 Score:</strong> <span id="gradLevel2Score">--/100</span></div>
                            <div>‚≠ê‚≠ê‚≠ê <strong>Level 3 Score:</strong> <span id="gradLevel3Score">--/100</span></div>
                            <div>üìä <strong>Total Score:</strong> <span id="gradTotalScore">--/300</span></div>
                            <div>üìÖ <strong>Date:</strong> <span id="gradDate">--</span></div>
                        </div>
                    </div>
                    
                    <div style="background: rgba(255,255,255,0.9); color: #333; padding: 25px; border-radius: 15px; margin: 30px 0;">
                        <h3 style="margin: 0 0 15px 0; font-size: 1.5em;">üéì Achievement Unlocked</h3>
                        <p style="font-size: 1.1em; margin: 0; line-height: 1.6;">
                            You have successfully mastered <strong>Rational Numbers</strong>!<br>
                            You demonstrated excellent understanding of:<br>
                            ‚úÖ Integer Operations<br>
                            ‚úÖ Fraction Operations<br>
                            ‚úÖ Decimal Operations<br>
                            ‚úÖ Mixed Operations<br>
                            ‚úÖ Real-World Applications<br>
                            ‚úÖ Long Word Problems
                            ‚úÖ Mixed Operations<br>
                            ‚úÖ Real-World Applications
                        </p>
                    </div>
                    
                    <div style="margin-top: 30px;">
                        <button class="btn-start" onclick="backToLevelSelect()" style="background: white; color: #f5576c; padding: 20px 40px; font-size: 1.3em;">
                            üè† Back to Level Select
                        </button>
                        <button class="btn-start" onclick="showLeaderboard()" style="background: #ffc107; color: #333; padding: 20px 40px; font-size: 1.3em; margin-left: 15px;">
                            üèÜ View Leaderboard
                        </button>
                    </div>
                    
                    <div style="margin-top: 30px; font-size: 0.9em; opacity: 0.8;">
                        üí° You can replay any level to improve your score!
                    </div>
                </div>
            </div>
        </div>

        <div id="leaderboardScreen" style="display: none;">
            <div class="start-container">
                <div class="start-icon">üèÜ</div>
                <h2 class="start-title">Leaderboard</h2>
                <div class="start-subtitle">Top Performers</div>
                
                <div id="leaderboardTable" style="margin: 30px 0; max-height: 500px; overflow-y: auto;">
                    <!-- Leaderboard will be inserted here -->
                </div>

                <button class="btn-start" onclick="backToMenu()">
                    ‚Üê Back to Menu
                </button>

                <button class="btn-start" onclick="showClearForm()" style="background: #dc3545; margin-top: 15px;">
                    üóëÔ∏è Clear Leaderboard (Teacher Only)
                </button>
            </div>
        </div>

        <!-- Ê∏ÖÈô§ÂØÜÁ†ÅÁïåÈù¢ Clear Password Screen -->
        <div id="clearPasswordScreen" style="display: none;">
            <div class="start-container">
                <div class="start-icon">üîê</div>
                <h2 class="start-title">Clear Leaderboard</h2>
                <div class="start-subtitle">Teacher Access Only</div>
                
                <div style="margin: 30px 0;">
                    <label style="font-size: 1.2em; font-weight: bold; display: block; margin-bottom: 10px;">
                        Enter Teacher Password:
                    </label>
                    <input type="password" id="clearPassword" placeholder="Enter password" 
                           style="width: 100%; padding: 15px; font-size: 1.2em; border: 3px solid #667eea; border-radius: 10px; margin-bottom: 20px;">
                    
                    <div id="clearMessage" style="padding: 15px; border-radius: 10px; margin-bottom: 20px; display: none;"></div>
                    
                    <button class="btn-start" onclick="checkPasswordAndClear()" style="background: #dc3545;">
                        ‚úì Confirm Clear Leaderboard
                    </button>
                    
                    <button class="btn-start" onclick="cancelClear()" style="background: #6c757d; margin-top: 15px;">
                        ‚úó Cancel
                    </button>
                </div>

                <div style="margin-top: 30px; padding: 20px; background: rgba(255,193,7,0.2); border-radius: 10px; border-left: 5px solid #ffc107;">
                    <strong>‚ö†Ô∏è Warning:</strong> This will permanently delete ALL student scores!
                </div>
            </div>
        </div>

        <!-- Á°ÆËÆ§ËøîÂõûËèúÂçïÁïåÈù¢ Confirm Back to Menu Screen -->
        <div id="confirmBackScreen" style="display: none;">
            <div class="start-container">
                <div class="start-icon">‚ö†Ô∏è</div>
                <h2 class="start-title">Back to Menu?</h2>
                <div class="start-subtitle">Confirm Your Action</div>
                
                <div style="margin: 30px 0; padding: 30px; background: rgba(255,193,7,0.2); border-radius: 15px; border-left: 5px solid #ffc107;">
                    <p style="font-size: 1.3em; margin-bottom: 20px;">
                        ‚ö†Ô∏è <strong>Are you sure you want to go back to menu?</strong>
                    </p>
                    <p style="font-size: 1.1em; color: #856404;">
                        Your current progress will be <strong>LOST</strong>!<br>
                        ‚Ä¢ Current score will not be saved<br>
                        ‚Ä¢ Timer will reset<br>
                        ‚Ä¢ All answers will be cleared
                    </p>
                </div>

                <button class="btn-start" onclick="confirmBackToMenu()" style="background: #dc3545;">
                    ‚úì Yes, Back to Menu
                </button>
                
                <button class="btn-start" onclick="cancelBackToMenu()" style="background: #28a745; margin-top: 15px;">
                    ‚úó No, Continue Game
                </button>
            </div>
        </div>
    </div>

    <script>
        // Text-to-Speech variables
        let speechSynthesis = window.speechSynthesis;
        let speechSpeed = 1.0;
        let isSpeaking = false;
        let currentStepIndex = 0;
        let allStepsData = [];

        // Timer variables
        let questionTimer = null;
        let timeLeft = 0;
        let totalTimeTaken = 0;

        // Sound effects using Web Audio API
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        function playCorrectSound() {
            // Happy ascending chime
            const frequencies = [523.25, 659.25, 783.99]; // C, E, G (major chord)
            frequencies.forEach((freq, i) => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = freq;
                oscillator.type = 'sine';
                
                const startTime = audioContext.currentTime + (i * 0.1);
                gainNode.gain.setValueAtTime(0.3, startTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, startTime + 0.3);
                
                oscillator.start(startTime);
                oscillator.stop(startTime + 0.3);
            });
        }

        function playWrongSound() {
            // Sad descending tone
            const frequencies = [440, 392, 349.23]; // A, G, F (descending)
            frequencies.forEach((freq, i) => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = freq;
                oscillator.type = 'triangle';
                
                const startTime = audioContext.currentTime + (i * 0.15);
                gainNode.gain.setValueAtTime(0.2, startTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, startTime + 0.4);
                
                oscillator.start(startTime);
                oscillator.stop(startTime + 0.4);
            });
        }

        function playTimeoutSound() {
            // Alarm-like buzzer
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 200;
            oscillator.type = 'sawtooth';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.5);
        }

        // Random emoji generators
        function getRandomCorrectEmoji() {
            const emojis = ['üéâ', 'üåü', '‚ú®', 'üéä', 'üèÜ', 'üëè', 'üíØ', 'üî•', '‚≠ê', 'üéØ', 'üí™', 'üòÑ', 'ü§©', 'ü•≥'];
            return emojis[Math.floor(Math.random() * emojis.length)];
        }

        function getRandomWrongEmoji() {
            const emojis = ['üò¢', 'üòû', 'üòî', 'üí™', 'ü§î', 'üìö', 'üí°', 'üéØ', 'üëç', 'üòä'];
            return emojis[Math.floor(Math.random() * emojis.length)];
        }

        function getRandomTimeoutEmoji() {
            const emojis = ['‚è∞', '‚åõ', 'üòÖ', 'üí®', '‚ö°', 'üèÉ', '‚è±Ô∏è'];
            return emojis[Math.floor(Math.random() * emojis.length)];
        }

        // Student names for leaderboard
        const studentNames = [
            "CHOW YOU CHEN Âë®ÂÆ•Ëæ∞",
            "CONSTANCE SIM JAY YING Ê≤àÊ¥ÅËéπ",
            "IAN LEE JUN WEI Êùé‰øäÊöê",
            "LIM YOU JAY Êûó‰ΩëÁàµ",
            "TAN YI XIN ÈôàÊÄ°ÂøÉ",
            "MAKIYO LIM SHIN EN ÊûóËäØÊÅ©",
            "FELICIA YEOH KE NING Êù®ÁèÇÂÆÅ",
            "LEE MIN HAO ÊùéÊóªÊòä",
            "TAN WEN JUN ÈôàÊñá‰øä",
            "JANICE OOI XIN YUE ÈªÑÊ¨£ÊÇ¶",
            "HO JACK HAOW ‰ΩïÊù∞Ë±™",
            "FOO JIA YEE Á¨¶ÂòâËØí",
            "CHLOE KUNG KE YEE Ê±üÂù∑Ë∞ï",
            "AIDEN TAN XU YUAN ÈôàÁª≠ÂÖÉ",
            "KEE JUN YI Á∫™È™èÈÄ∏",
            "UNG JING ERN Ê¥™ÈùñÊÅ©",
            "TEOH KHAI JUN Âº†ÊÅ∫Âùá"
        ];

        // Get leaderboard from localStorage
        function getLeaderboard() {
            const saved = localStorage.getItem('rationalNumbersLeaderboard');
            return saved ? JSON.parse(saved) : [];
        }

        // Save leaderboard to localStorage
        function saveLeaderboard(leaderboard) {
            localStorage.setItem('rationalNumbersLeaderboard', JSON.stringify(leaderboard));
        }

        const questions = [
            // Level 1: Integer Addition (1-10) - 5 points for correct
            {q: "5 + (-3)", ans: "2", level: 1, points: 5, hint: "Positive + Negative: Subtract and keep sign of larger number",
             methods: [
                 {title: "Method 1: Number line", steps: ["Start at 5", "Move 3 steps left (because -3)", "You land on 2", "Answer: 2"]},
                 {title: "Method 2: Same sign rule", steps: ["5 + (-3) = 5 - 3", "Subtract: 5 - 3 = 2", "Answer: 2"]}
             ]},
            {q: "(-7) + 4", ans: "-3", level: 1, points: 5, hint: "Negative + Positive: Subtract and keep sign of larger",
             methods: [
                 {title: "Method 1: Number line", steps: ["Start at -7", "Move 4 steps right (because +4)", "You land on -3", "Answer: -3"]},
                 {title: "Method 2: Calculate", steps: ["(-7) + 4", "7 > 4, so answer is negative", "7 - 4 = 3", "Answer: -3"]}
             ]},
            {q: "(-8) + (-5)", ans: "-13", level: 1, points: 5, hint: "Negative + Negative: Add and keep negative sign",
             methods: [
                 {title: "Method 1: Same signs add", steps: ["Both negative, add them", "8 + 5 = 13", "Keep negative sign", "Answer: -13"]},
                 {title: "Method 2: Number line", steps: ["Start at -8", "Move 5 more steps left", "You land on -13"]}
             ]},
            {q: "12 + (-8)", ans: "4", level: 1, points: 5, hint: "Large positive + small negative = subtract",
             methods: [
                 {title: "Method 1: Subtract", steps: ["12 + (-8) = 12 - 8", "12 - 8 = 4", "Answer: 4"]},
                 {title: "Method 2: Think", steps: ["12 is bigger than 8", "Subtract: 12 - 8 = 4", "Keep positive"]}
             ]},
            {q: "(-10) + 15", ans: "5", level: 1, points: 5, hint: "15 is larger, answer is positive",
             methods: [
                 {title: "Method 1: Compare sizes", steps: ["15 > 10, answer is positive", "15 - 10 = 5", "Answer: 5"]},
                 {title: "Method 2: Calculate", steps: ["(-10) + 15", "15 - 10 = 5", "Answer: 5"]}
             ]},
            {q: "6 + (-6)", ans: "0", level: 1, points: 5, hint: "Same number, opposite signs = 0",
             methods: [
                 {title: "Method 1: Opposites cancel", steps: ["6 and -6 are opposites", "They cancel out", "Answer: 0"]},
                 {title: "Method 2: Subtract", steps: ["6 - 6 = 0", "Answer: 0"]}
             ]},
            {q: "(-3) + (-7)", ans: "-10", level: 1, points: 5, hint: "Both negative: add and keep negative",
             methods: [
                 {title: "Method 1: Add negatives", steps: ["3 + 7 = 10", "Keep negative sign", "Answer: -10"]},
                 {title: "Method 2: Number line", steps: ["Start at -3", "Move 7 left", "Answer: -10"]}
             ]},
            {q: "9 + (-12)", ans: "-3", level: 1, points: 5, hint: "12 > 9, answer is negative",
             methods: [
                 {title: "Method 1: Compare", steps: ["12 > 9, answer is negative", "12 - 9 = 3", "Answer: -3"]},
                 {title: "Method 2: Calculate", steps: ["9 - 12 = -3", "Answer: -3"]}
             ]},
            {q: "(-15) + 8", ans: "-7", level: 1, points: 5, hint: "15 > 8, keep negative",
             methods: [
                 {title: "Method 1: Subtract", steps: ["15 > 8, answer is negative", "15 - 8 = 7", "Answer: -7"]},
                 {title: "Method 2: Number line", steps: ["Start at -15", "Move 8 right", "Answer: -7"]}
             ]},
            {q: "0 + (-9)", ans: "-9", level: 1, points: 5, hint: "Adding to zero gives the number itself",
             methods: [
                 {title: "Method 1: Zero property", steps: ["0 + any number = that number", "Answer: -9"]},
                 {title: "Method 2: Think", steps: ["Starting from 0", "Go 9 steps left", "Answer: -9"]}
             ]},

            // Level 2: Integer Subtraction (11-20) - 1 point each
            {q: "7 - 3", ans: "4", level: 2, points: 5, hint: "Simple subtraction",
             methods: [
                 {title: "Method 1: Direct subtract", steps: ["7 - 3 = 4", "Answer: 4"]},
                 {title: "Method 2: Count back", steps: ["From 7, count back 3", "7, 6, 5, 4", "Answer: 4"]}
             ]},
            {q: "5 - (-3)", ans: "8", level: 2, points: 5, hint: "Minus a negative = add positive",
             methods: [
                 {title: "Method 1: Double negative rule", steps: ["5 - (-3) = 5 + 3", "5 + 3 = 8", "Answer: 8"]},
                 {title: "Method 2: Think", steps: ["Subtracting negative means adding", "5 + 3 = 8"]}
             ]},
            {q: "(-8) - 4", ans: "-12", level: 2, points: 5, hint: "Negative - positive: add and keep negative",
             methods: [
                 {title: "Method 1: Add negatives", steps: ["(-8) - 4 = (-8) + (-4)", "8 + 4 = 12", "Keep negative: -12"]},
                 {title: "Method 2: Number line", steps: ["Start at -8", "Move 4 left", "Answer: -12"]}
             ]},
            {q: "10 - 15", ans: "-5", level: 2, points: 5, hint: "Smaller minus larger = negative",
             methods: [
                 {title: "Method 1: Reverse", steps: ["10 < 15, answer is negative", "15 - 10 = 5", "Answer: -5"]},
                 {title: "Method 2: Think", steps: ["10 - 15 = -(15 - 10)", "= -5"]}
             ]},
            {q: "(-6) - (-9)", ans: "3", level: 2, points: 5, hint: "Two negatives become positive",
             methods: [
                 {title: "Method 1: Double negative", steps: ["(-6) - (-9) = (-6) + 9", "9 - 6 = 3", "Answer: 3"]},
                 {title: "Method 2: Simplify", steps: ["-6 + 9 = 3", "Answer: 3"]}
             ]},
            {q: "0 - 7", ans: "-7", level: 2, points: 5, hint: "Zero minus positive = negative",
             methods: [
                 {title: "Method 1: Zero property", steps: ["0 - 7 = -7", "Answer: -7"]},
                 {title: "Method 2: Think", steps: ["Starting from 0", "Go 7 steps left", "Answer: -7"]}
             ]},
            {q: "12 - (-5)", ans: "17", level: 2, points: 5, hint: "Minus negative = add",
             methods: [
                 {title: "Method 1: Change sign", steps: ["12 - (-5) = 12 + 5", "12 + 5 = 17", "Answer: 17"]},
                 {title: "Method 2: Double negative", steps: ["Two negatives make positive", "12 + 5 = 17"]}
             ]},
            {q: "(-11) - 6", ans: "-17", level: 2, points: 5, hint: "Both contribute to negative",
             methods: [
                 {title: "Method 1: Add", steps: ["(-11) - 6 = (-11) + (-6)", "11 + 6 = 17", "Answer: -17"]},
                 {title: "Method 2: Number line", steps: ["Start at -11", "Move 6 left", "Answer: -17"]}
             ]},
            {q: "8 - 8", ans: "0", level: 2, points: 5, hint: "Same number minus itself = 0",
             methods: [
                 {title: "Method 1: Direct", steps: ["8 - 8 = 0", "Answer: 0"]},
                 {title: "Method 2: Think", steps: ["Any number minus itself is 0"]}
             ]},
            {q: "(-4) - (-4)", ans: "0", level: 2, points: 5, hint: "Same number, becomes zero",
             methods: [
                 {title: "Method 1: Simplify", steps: ["(-4) - (-4) = (-4) + 4", "= 0"]},
                 {title: "Method 2: Opposites", steps: ["-4 and +4 are opposites", "They cancel to 0"]}
             ]},

            // Level 3: Integer Multiplication (21-30) - 2 points each
            {q: "5 √ó (-3)", ans: "-15", level: 3, points: 5, hint: "Positive √ó Negative = Negative",
             methods: [
                 {title: "Method 1: Sign rule", steps: ["5 √ó 3 = 15", "Different signs = negative", "Answer: -15"]},
                 {title: "Method 2: Repeated addition", steps: ["(-3) + (-3) + (-3) + (-3) + (-3)", "= -15"]}
             ]},
            {q: "(-4) √ó 6", ans: "-24", level: 3, points: 5, hint: "Negative √ó Positive = Negative",
             methods: [
                 {title: "Method 1: Multiply then sign", steps: ["4 √ó 6 = 24", "Different signs = negative", "Answer: -24"]},
                 {title: "Method 2: Sign rule", steps: ["Neg √ó Pos = Neg", "4 √ó 6 = 24", "Answer: -24"]}
             ]},
            {q: "(-7) √ó (-2)", ans: "14", level: 3, points: 5, hint: "Negative √ó Negative = Positive",
             methods: [
                 {title: "Method 1: Two negatives", steps: ["7 √ó 2 = 14", "Same signs = positive", "Answer: 14"]},
                 {title: "Method 2: Sign rule", steps: ["Neg √ó Neg = Pos", "7 √ó 2 = 14"]}
             ]},
            {q: "8 √ó (-5)", ans: "-40", level: 3, points: 5, hint: "Different signs = negative result",
             methods: [
                 {title: "Method 1: Calculate", steps: ["8 √ó 5 = 40", "Different signs", "Answer: -40"]},
                 {title: "Method 2: Think", steps: ["Pos √ó Neg = Neg", "8 √ó 5 = 40, so -40"]}
             ]},
            {q: "(-9) √ó (-3)", ans: "27", level: 3, points: 5, hint: "Two negatives make positive",
             methods: [
                 {title: "Method 1: Sign rule", steps: ["9 √ó 3 = 27", "Both negative = positive", "Answer: 27"]},
                 {title: "Method 2: Multiply", steps: ["Neg √ó Neg = Pos", "9 √ó 3 = 27"]}
             ]},
            {q: "0 √ó (-8)", ans: "0", level: 3, points: 5, hint: "Zero times anything = zero",
             methods: [
                 {title: "Method 1: Zero property", steps: ["0 √ó any number = 0", "Answer: 0"]},
                 {title: "Method 2: Think", steps: ["Zero groups of -8 = 0"]}
             ]},
            {q: "(-6) √ó 4", ans: "-24", level: 3, points: 5, hint: "Negative times positive",
             methods: [
                 {title: "Method 1: Calculate", steps: ["6 √ó 4 = 24", "Negative result", "Answer: -24"]},
                 {title: "Method 2: Sign", steps: ["Different signs = negative", "6 √ó 4 = 24", "Answer: -24"]}
             ]},
            {q: "3 √ó (-7)", ans: "-21", level: 3, points: 5, hint: "Positive √ó Negative = Negative",
             methods: [
                 {title: "Method 1: Multiply", steps: ["3 √ó 7 = 21", "Different signs", "Answer: -21"]},
                 {title: "Method 2: Repeated", steps: ["(-7) + (-7) + (-7) = -21"]}
             ]},
            {q: "(-10) √ó (-1)", ans: "10", level: 3, points: 5, hint: "Times -1 changes sign",
             methods: [
                 {title: "Method 1: Sign rule", steps: ["10 √ó 1 = 10", "Same signs = positive", "Answer: 10"]},
                 {title: "Method 2: Special", steps: ["Any number √ó (-1) changes sign", "-10 becomes 10"]}
             ]},
            {q: "(-5) √ó 5", ans: "-25", level: 3, points: 5, hint: "Different signs = negative",
             methods: [
                 {title: "Method 1: Calculate", steps: ["5 √ó 5 = 25", "Different signs", "Answer: -25"]},
                 {title: "Method 2: Think", steps: ["Neg √ó Pos = Neg", "5 √ó 5 = 25, so -25"]}
             ]},

            // Level 4: Integer Division (31-40) - 3 points each
            {q: "12 √∑ (-3)", ans: "-4", level: 4, points: 5, hint: "Positive √∑ Negative = Negative",
             methods: [
                 {title: "Method 1: Division", steps: ["12 √∑ 3 = 4", "Different signs = negative", "Answer: -4"]},
                 {title: "Method 2: Think", steps: ["Pos √∑ Neg = Neg", "12 √∑ 3 = 4", "Answer: -4"]}
             ]},
            {q: "(-20) √∑ 4", ans: "-5", level: 4, points: 5, hint: "Negative √∑ Positive = Negative",
             methods: [
                 {title: "Method 1: Divide", steps: ["20 √∑ 4 = 5", "Different signs", "Answer: -5"]},
                 {title: "Method 2: Sign rule", steps: ["Neg √∑ Pos = Neg", "20 √∑ 4 = 5, so -5"]}
             ]},
            {q: "(-18) √∑ (-3)", ans: "6", level: 4, points: 5, hint: "Negative √∑ Negative = Positive",
             methods: [
                 {title: "Method 1: Same signs", steps: ["18 √∑ 3 = 6", "Same signs = positive", "Answer: 6"]},
                 {title: "Method 2: Sign rule", steps: ["Neg √∑ Neg = Pos", "18 √∑ 3 = 6"]}
             ]},
            {q: "24 √∑ (-6)", ans: "-4", level: 4, points: 5, hint: "Different signs = negative",
             methods: [
                 {title: "Method 1: Calculate", steps: ["24 √∑ 6 = 4", "Different signs", "Answer: -4"]},
                 {title: "Method 2: Think", steps: ["Pos √∑ Neg = Neg", "24 √∑ 6 = 4, so -4"]}
             ]},
            {q: "(-35) √∑ (-7)", ans: "5", level: 4, points: 5, hint: "Both negative = positive",
             methods: [
                 {title: "Method 1: Divide", steps: ["35 √∑ 7 = 5", "Same signs = positive", "Answer: 5"]},
                 {title: "Method 2: Sign rule", steps: ["Neg √∑ Neg = Pos", "35 √∑ 7 = 5"]}
             ]},
            {q: "0 √∑ (-5)", ans: "0", level: 4, points: 5, hint: "Zero divided by anything = zero",
             methods: [
                 {title: "Method 1: Zero property", steps: ["0 √∑ any number = 0", "Answer: 0"]},
                 {title: "Method 2: Think", steps: ["Zero split into groups = 0 in each"]}
             ]},
            {q: "(-48) √∑ 8", ans: "-6", level: 4, points: 5, hint: "Negative √∑ Positive = Negative",
             methods: [
                 {title: "Method 1: Calculate", steps: ["48 √∑ 8 = 6", "Different signs", "Answer: -6"]},
                 {title: "Method 2: Sign", steps: ["Neg √∑ Pos = Neg", "48 √∑ 8 = 6, so -6"]}
             ]},
            {q: "36 √∑ (-9)", ans: "-4", level: 4, points: 5, hint: "Positive √∑ Negative = Negative",
             methods: [
                 {title: "Method 1: Divide", steps: ["36 √∑ 9 = 4", "Different signs", "Answer: -4"]},
                 {title: "Method 2: Think", steps: ["Pos √∑ Neg = Neg", "36 √∑ 9 = 4, so -4"]}
             ]},
            {q: "(-42) √∑ (-6)", ans: "7", level: 4, points: 5, hint: "Same signs = positive",
             methods: [
                 {title: "Method 1: Calculate", steps: ["42 √∑ 6 = 7", "Same signs = positive", "Answer: 7"]},
                 {title: "Method 2: Sign rule", steps: ["Neg √∑ Neg = Pos", "42 √∑ 6 = 7"]}
             ]},
            {q: "(-30) √∑ 5", ans: "-6", level: 4, points: 5, hint: "Different signs = negative",
             methods: [
                 {title: "Method 1: Divide", steps: ["30 √∑ 5 = 6", "Different signs", "Answer: -6"]},
                 {title: "Method 2: Think", steps: ["Neg √∑ Pos = Neg", "30 √∑ 5 = 6, so -6"]}
             ]},

            // Level 5: Mixed Operations (41-50) - 3 points each
            {q: "5 + 3 √ó 2", ans: "11", level: 5, points: 5, hint: "BODMAS: Multiply first",
             methods: [
                 {title: "Method 1: BODMAS", steps: ["Multiply first: 3 √ó 2 = 6", "Then add: 5 + 6 = 11", "Answer: 11"]},
                 {title: "Method 2: Order matters", steps: ["Don't do 5+3 first!", "3 √ó 2 = 6", "5 + 6 = 11"]}
             ]},
            {q: "(-4) + 2 √ó 5", ans: "6", level: 5, points: 5, hint: "Multiply before adding",
             methods: [
                 {title: "Method 1: BODMAS", steps: ["Multiply: 2 √ó 5 = 10", "Add: (-4) + 10 = 6", "Answer: 6"]},
                 {title: "Method 2: Step by step", steps: ["2 √ó 5 = 10", "-4 + 10 = 6"]}
             ]},
            {q: "12 √∑ 3 + 2", ans: "6", level: 5, points: 5, hint: "Divide first, then add",
             methods: [
                 {title: "Method 1: BODMAS", steps: ["Divide: 12 √∑ 3 = 4", "Add: 4 + 2 = 6", "Answer: 6"]},
                 {title: "Method 2: Left to right", steps: ["12 √∑ 3 = 4", "4 + 2 = 6"]}
             ]},
            {q: "8 - 2 √ó 3", ans: "2", level: 5, points: 5, hint: "Multiply before subtracting",
             methods: [
                 {title: "Method 1: BODMAS", steps: ["Multiply: 2 √ó 3 = 6", "Subtract: 8 - 6 = 2", "Answer: 2"]},
                 {title: "Method 2: Order", steps: ["2 √ó 3 = 6", "8 - 6 = 2"]}
             ]},
            {q: "(-10) √∑ 2 + 3", ans: "-2", level: 5, points: 5, hint: "Divide first",
             methods: [
                 {title: "Method 1: BODMAS", steps: ["Divide: (-10) √∑ 2 = -5", "Add: -5 + 3 = -2", "Answer: -2"]},
                 {title: "Method 2: Step by step", steps: ["-10 √∑ 2 = -5", "-5 + 3 = -2"]}
             ]},
            {q: "6 √ó 2 - 4", ans: "8", level: 5, points: 5, hint: "Multiply first",
             methods: [
                 {title: "Method 1: BODMAS", steps: ["Multiply: 6 √ó 2 = 12", "Subtract: 12 - 4 = 8", "Answer: 8"]},
                 {title: "Method 2: Calculate", steps: ["6 √ó 2 = 12", "12 - 4 = 8"]}
             ]},
            {q: "15 - 12 √∑ 3", ans: "11", level: 5, points: 5, hint: "Divide before subtracting",
             methods: [
                 {title: "Method 1: BODMAS", steps: ["Divide: 12 √∑ 3 = 4", "Subtract: 15 - 4 = 11", "Answer: 11"]},
                 {title: "Method 2: Order", steps: ["12 √∑ 3 = 4", "15 - 4 = 11"]}
             ]},
            {q: "(-3) √ó 2 + 8", ans: "2", level: 5, points: 5, hint: "Multiply first",
             methods: [
                 {title: "Method 1: BODMAS", steps: ["Multiply: (-3) √ó 2 = -6", "Add: -6 + 8 = 2", "Answer: 2"]},
                 {title: "Method 2: Calculate", steps: ["-3 √ó 2 = -6", "-6 + 8 = 2"]}
             ]},
            {q: "20 √∑ 4 - 3", ans: "2", level: 5, points: 5, hint: "Divide then subtract",
             methods: [
                 {title: "Method 1: BODMAS", steps: ["Divide: 20 √∑ 4 = 5", "Subtract: 5 - 3 = 2", "Answer: 2"]},
                 {title: "Method 2: Step by step", steps: ["20 √∑ 4 = 5", "5 - 3 = 2"]}
             ]},
            {q: "4 + (-2) √ó 3", ans: "-2", level: 5, points: 5, hint: "Multiply before adding",
             methods: [
                 {title: "Method 1: BODMAS", steps: ["Multiply: (-2) √ó 3 = -6", "Add: 4 + (-6) = -2", "Answer: -2"]},
                 {title: "Method 2: Calculate", steps: ["-2 √ó 3 = -6", "4 - 6 = -2"]}
             ]}
        ];

        // Level 2 Questions - 50 Advanced Questions (Fractions, Decimals, Word Problems)
        const questionsLevel2 = [
            // Fraction Addition (Q1-10) 
            {q: "1/2 + 1/4", ans: "3/4", level: 1, points: 5, hint: "Common denominator: 4",
             methods: [
                 {title: "Method 1: Common denominator", steps: ["1/2 = 2/4", "2/4 + 1/4 = 3/4"]},
                 {title: "Method 2: LCD", steps: ["LCD = 4", "2/4 + 1/4 = 3/4"]}
             ]},
            {q: "2/3 + 1/6", ans: "5/6", level: 1, points: 5, hint: "Common denominator: 6",
             methods: [
                 {title: "Method 1: Convert", steps: ["2/3 = 4/6", "4/6 + 1/6 = 5/6"]},
                 {title: "Method 2: Calculate", steps: ["2/3 √ó 2 = 4/6", "4/6 + 1/6 = 5/6"]}
             ]},
            {q: "3/4 + 1/8", ans: "7/8", level: 1, points: 5, hint: "Common denominator: 8",
             methods: [
                 {title: "Method 1: Convert", steps: ["3/4 = 6/8", "6/8 + 1/8 = 7/8"]},
                 {title: "Method 2: Multiply", steps: ["3/4 √ó 2 = 6/8", "6 + 1 = 7", "7/8"]}
             ]},
            {q: "1/3 + 1/3", ans: "2/3", level: 1, points: 5, hint: "Same denominator",
             methods: [
                 {title: "Method 1: Add", steps: ["(1+1)/3 = 2/3"]},
                 {title: "Method 2: Direct", steps: ["1/3 + 1/3 = 2/3"]}
             ]},
            {q: "2/5 + 1/5", ans: "3/5", level: 1, points: 5, hint: "Same denominator",
             methods: [
                 {title: "Method 1: Add", steps: ["(2+1)/5 = 3/5"]},
                 {title: "Method 2: Simple", steps: ["2/5 + 1/5 = 3/5"]}
             ]},
            {q: "1/2 + 1/3", ans: "5/6", level: 1, points: 5, hint: "LCD = 6",
             methods: [
                 {title: "Method 1: Convert", steps: ["1/2 = 3/6, 1/3 = 2/6", "3/6 + 2/6 = 5/6"]},
                 {title: "Method 2: LCD", steps: ["LCD = 6", "3/6 + 2/6 = 5/6"]}
             ]},
            {q: "3/5 + 1/10", ans: "7/10", level: 1, points: 5, hint: "LCD = 10",
             methods: [
                 {title: "Method 1: Convert", steps: ["3/5 = 6/10", "6/10 + 1/10 = 7/10"]},
                 {title: "Method 2: Calculate", steps: ["3/5 √ó 2 = 6/10", "6 + 1 = 7"]}
             ]},
            {q: "1/4 + 2/4", ans: "3/4", level: 1, points: 5, hint: "Same denominator",
             methods: [
                 {title: "Method 1: Add", steps: ["(1+2)/4 = 3/4"]},
                 {title: "Method 2: Simple", steps: ["1/4 + 2/4 = 3/4"]}
             ]},
            {q: "2/3 + 2/3", ans: "4/3", level: 1, points: 5, hint: "Answer > 1",
             methods: [
                 {title: "Method 1: Add", steps: ["(2+2)/3 = 4/3 = 1 1/3"]},
                 {title: "Method 2: Calculate", steps: ["2 + 2 = 4", "4/3"]}
             ]},
            {q: "1/6 + 1/2", ans: "2/3", level: 1, points: 5, hint: "LCD = 6, then simplify",
             methods: [
                 {title: "Method 1: Convert", steps: ["1/2 = 3/6", "1/6 + 3/6 = 4/6 = 2/3"]},
                 {title: "Method 2: Simplify", steps: ["4/6 √∑ 2 = 2/3"]}
             ]},

            // Fraction Subtraction & Multiplication (Q11-20)
            {q: "3/4 - 1/4", ans: "1/2", level: 2, points: 5, hint: "Subtract then simplify",
             methods: [
                 {title: "Method 1: Subtract", steps: ["(3-1)/4 = 2/4 = 1/2"]},
                 {title: "Method 2: Reduce", steps: ["2/4 √∑ 2 = 1/2"]}
             ]},
            {q: "2/3 - 1/6", ans: "1/2", level: 2, points: 5, hint: "LCD = 6",
             methods: [
                 {title: "Method 1: Convert", steps: ["2/3 = 4/6", "4/6 - 1/6 = 3/6 = 1/2"]},
                 {title: "Method 2: LCD", steps: ["LCD = 6", "4/6 - 1/6 = 3/6 = 1/2"]}
             ]},
            {q: "1/2 √ó 1/3", ans: "1/6", level: 2, points: 5, hint: "Multiply across",
             methods: [
                 {title: "Method 1: Multiply", steps: ["1 √ó 1 = 1", "2 √ó 3 = 6", "1/6"]},
                 {title: "Method 2: Direct", steps: ["(1√ó1)/(2√ó3) = 1/6"]}
             ]},
            {q: "2/3 √ó 3/4", ans: "1/2", level: 2, points: 5, hint: "Can cancel 3s",
             methods: [
                 {title: "Method 1: Multiply", steps: ["6/12 = 1/2"]},
                 {title: "Method 2: Cancel", steps: ["Cancel 3s: 2/4 = 1/2"]}
             ]},
            {q: "1/2 √ó 4", ans: "2", level: 2, points: 5, hint: "4 = 4/1",
             methods: [
                 {title: "Method 1: Convert", steps: ["1/2 √ó 4/1 = 4/2 = 2"]},
                 {title: "Method 2: Direct", steps: ["Half of 4 = 2"]}
             ]},
            {q: "3/5 √ó 5/6", ans: "1/2", level: 2, points: 5, hint: "Cancel 5s first",
             methods: [
                 {title: "Method 1: Cancel", steps: ["Cancel 5: 3/6 = 1/2"]},
                 {title: "Method 2: Multiply", steps: ["15/30 = 1/2"]}
             ]},
            {q: "1/2 √∑ 2", ans: "1/4", level: 2, points: 5, hint: "Flip & multiply",
             methods: [
                 {title: "Method 1: Flip", steps: ["1/2 √ó 1/2 = 1/4"]},
                 {title: "Method 2: Direct", steps: ["1/(2√ó2) = 1/4"]}
             ]},
            {q: "2/3 √∑ 4", ans: "1/6", level: 2, points: 5, hint: "Multiply by 1/4",
             methods: [
                 {title: "Method 1: Flip", steps: ["2/3 √ó 1/4 = 2/12 = 1/6"]},
                 {title: "Method 2: Calculate", steps: ["2/(3√ó4) = 2/12 = 1/6"]}
             ]},
            {q: "3/4 √ó 2/3", ans: "1/2", level: 2, points: 5, hint: "Simplify",
             methods: [
                 {title: "Method 1: Multiply", steps: ["6/12 = 1/2"]},
                 {title: "Method 2: Cancel", steps: ["Cancel 3: 2/4 = 1/2"]}
             ]},
            {q: "5/6 - 1/3", ans: "1/2", level: 2, points: 5, hint: "LCD = 6",
             methods: [
                 {title: "Method 1: Convert", steps: ["1/3 = 2/6", "5/6 - 2/6 = 3/6 = 1/2"]},
                 {title: "Method 2: Simplify", steps: ["3/6 = 1/2"]}
             ]},

            // Decimal Operations (Q21-30)
            {q: "0.5 + 0.3", ans: "0.8", level: 3, points: 5, hint: "Add decimals",
             methods: [
                 {title: "Method 1: Add", steps: ["Line up: 0.5 + 0.3 = 0.8"]},
                 {title: "Method 2: Think", steps: ["5/10 + 3/10 = 8/10 = 0.8"]}
             ]},
            {q: "1.5 - 0.7", ans: "0.8", level: 3, points: 5, hint: "Subtract",
             methods: [
                 {title: "Method 1: Subtract", steps: ["1.5 - 0.7 = 0.8"]},
                 {title: "Method 2: Regroup", steps: ["15/10 - 7/10 = 8/10 = 0.8"]}
             ]},
            {q: "0.2 √ó 5", ans: "1", level: 3, points: 5, hint: "0.2 √ó 5",
             methods: [
                 {title: "Method 1: Multiply", steps: ["0.2 √ó 5 = 1.0 = 1"]},
                 {title: "Method 2: Fraction", steps: ["1/5 √ó 5 = 1"]}
             ]},
            {q: "0.8 + 0.6", ans: "1.4", level: 3, points: 5, hint: "Regroup",
             methods: [
                 {title: "Method 1: Add", steps: ["0.8 + 0.6 = 1.4"]},
                 {title: "Method 2: Think", steps: ["8 + 6 = 14", "1.4"]}
             ]},
            {q: "2.5 - 1.3", ans: "1.2", level: 3, points: 5, hint: "Subtract",
             methods: [
                 {title: "Method 1: Subtract", steps: ["2.5 - 1.3 = 1.2"]},
                 {title: "Method 2: Parts", steps: ["2 - 1 = 1", "0.5 - 0.3 = 0.2"]}
             ]},
            {q: "0.4 √ó 10", ans: "4", level: 3, points: 5, hint: "Move decimal",
             methods: [
                 {title: "Method 1: Multiply", steps: ["Move decimal right", "0.4 ‚Üí 4"]},
                 {title: "Method 2: Calculate", steps: ["0.4 √ó 10 = 4"]}
             ]},
            {q: "1.0 √∑ 2", ans: "0.5", level: 3, points: 5, hint: "Half",
             methods: [
                 {title: "Method 1: Divide", steps: ["1.0 √∑ 2 = 0.5"]},
                 {title: "Method 2: Know", steps: ["1/2 = 0.5"]}
             ]},
            {q: "0.3 + 0.9", ans: "1.2", level: 3, points: 5, hint: "Add",
             methods: [
                 {title: "Method 1: Add", steps: ["0.3 + 0.9 = 1.2"]},
                 {title: "Method 2: Think", steps: ["3 + 9 = 12", "1.2"]}
             ]},
            {q: "3.0 - 0.5", ans: "2.5", level: 3, points: 5, hint: "Subtract",
             methods: [
                 {title: "Method 1: Subtract", steps: ["3.0 - 0.5 = 2.5"]},
                 {title: "Method 2: Simple", steps: ["3 - 0.5 = 2.5"]}
             ]},
            {q: "0.25 √ó 4", ans: "1", level: 3, points: 5, hint: "Quarter √ó 4",
             methods: [
                 {title: "Method 1: Multiply", steps: ["0.25 √ó 4 = 1"]},
                 {title: "Method 2: Fraction", steps: ["1/4 √ó 4 = 1"]}
             ]},

            // Mixed Fractions & Decimals (Q31-40)
            {q: "0.5 + 1/2", ans: "1", level: 4, points: 5, hint: "0.5 = 1/2",
             methods: [
                 {title: "Method 1: Convert", steps: ["0.5 = 1/2", "1/2 + 1/2 = 1"]},
                 {title: "Method 2: Add", steps: ["0.5 + 0.5 = 1"]}
             ]},
            {q: "0.75 + 1/4", ans: "1", level: 4, points: 5, hint: "0.75 = 3/4",
             methods: [
                 {title: "Method 1: Convert", steps: ["0.75 = 3/4", "3/4 + 1/4 = 1"]},
                 {title: "Method 2: Decimal", steps: ["1/4 = 0.25", "0.75 + 0.25 = 1"]}
             ]},
            {q: "1/2 + 0.25", ans: "0.75", level: 4, points: 5, hint: "1/2 = 0.5",
             methods: [
                 {title: "Method 1: Decimal", steps: ["1/2 = 0.5", "0.5 + 0.25 = 0.75"]},
                 {title: "Method 2: Fraction", steps: ["0.25 = 1/4", "1/2 + 1/4 = 3/4"]}
             ]},
            {q: "0.6 - 1/5", ans: "0.4", level: 4, points: 5, hint: "1/5 = 0.2",
             methods: [
                 {title: "Method 1: Convert", steps: ["1/5 = 0.2", "0.6 - 0.2 = 0.4"]},
                 {title: "Method 2: Fraction", steps: ["0.6 = 3/5", "3/5 - 1/5 = 2/5 = 0.4"]}
             ]},
            {q: "1/4 √ó 2", ans: "0.5", level: 4, points: 5, hint: "Multiply",
             methods: [
                 {title: "Method 1: Multiply", steps: ["1/4 √ó 2 = 2/4 = 1/2 = 0.5"]},
                 {title: "Method 2: Convert", steps: ["1/4 = 0.25", "0.25 √ó 2 = 0.5"]}
             ]},
            {q: "0.2 + 3/10", ans: "0.5", level: 4, points: 5, hint: "0.2 = 2/10",
             methods: [
                 {title: "Method 1: Fraction", steps: ["0.2 = 2/10", "2/10 + 3/10 = 5/10 = 0.5"]},
                 {title: "Method 2: Decimal", steps: ["3/10 = 0.3", "0.2 + 0.3 = 0.5"]}
             ]},
            {q: "1.0 - 1/2", ans: "0.5", level: 4, points: 5, hint: "1 - 0.5",
             methods: [
                 {title: "Method 1: Convert", steps: ["1/2 = 0.5", "1.0 - 0.5 = 0.5"]},
                 {title: "Method 2: Fraction", steps: ["1 = 2/2", "2/2 - 1/2 = 1/2"]}
             ]},
            {q: "0.4 + 2/5", ans: "0.8", level: 4, points: 5, hint: "2/5 = 0.4",
             methods: [
                 {title: "Method 1: Convert", steps: ["2/5 = 0.4", "0.4 + 0.4 = 0.8"]},
                 {title: "Method 2: Fraction", steps: ["0.4 = 2/5", "2/5 + 2/5 = 4/5 = 0.8"]}
             ]},
            {q: "3/4 - 0.5", ans: "0.25", level: 4, points: 5, hint: "0.5 = 1/2",
             methods: [
                 {title: "Method 1: Convert", steps: ["0.5 = 2/4", "3/4 - 2/4 = 1/4 = 0.25"]},
                 {title: "Method 2: Decimal", steps: ["3/4 = 0.75", "0.75 - 0.5 = 0.25"]}
             ]},
            {q: "0.5 √ó 1/2", ans: "0.25", level: 4, points: 5, hint: "Half of half",
             methods: [
                 {title: "Method 1: Convert", steps: ["0.5 = 1/2", "1/2 √ó 1/2 = 1/4 = 0.25"]},
                 {title: "Method 2: Multiply", steps: ["0.5 √ó 0.5 = 0.25"]}
             ]},

            // Word Problems (Q41-50)
            {q: "Ali ate 1/4 pizza, Siti ate 1/2. Total?", ans: "3/4", level: 5, points: 5, hint: "Add fractions",
             methods: [
                 {title: "Method 1: Add", steps: ["1/4 + 1/2 = 1/4 + 2/4 = 3/4"]},
                 {title: "Method 2: Convert", steps: ["1/2 = 2/4", "1/4 + 2/4 = 3/4"]}
             ]},
            {q: "Bottle had 1L. Drank 0.3L. Left?", ans: "0.7", level: 5, points: 5, hint: "Subtract",
             methods: [
                 {title: "Method 1: Subtract", steps: ["1.0 - 0.3 = 0.7L"]},
                 {title: "Method 2: Think", steps: ["1 - 0.3 = 0.7"]}
             ]},
            {q: "Half of 0.8 is?", ans: "0.4", level: 5, points: 5, hint: "√∑ 2",
             methods: [
                 {title: "Method 1: Divide", steps: ["0.8 √∑ 2 = 0.4"]},
                 {title: "Method 2: Half", steps: ["1/2 of 0.8 = 0.4"]}
             ]},
            {q: "2/3 of 12 is?", ans: "8", level: 5, points: 5, hint: "Multiply",
             methods: [
                 {title: "Method 1: Multiply", steps: ["2/3 √ó 12 = 24/3 = 8"]},
                 {title: "Method 2: Calculate", steps: ["12 √∑ 3 = 4", "4 √ó 2 = 8"]}
             ]},
            {q: "Share RM10 equally between 2. Each?", ans: "5", level: 5, points: 5, hint: "√∑ 2",
             methods: [
                 {title: "Method 1: Divide", steps: ["10 √∑ 2 = 5", "RM5 each"]},
                 {title: "Method 2: Half", steps: ["Half of 10 = 5"]}
             ]},
            {q: "Rope 2.5m. Cut 0.5m. Left?", ans: "2", level: 5, points: 5, hint: "Subtract",
             methods: [
                 {title: "Method 1: Subtract", steps: ["2.5 - 0.5 = 2.0m"]},
                 {title: "Method 2: Calculate", steps: ["2.5 - 0.5 = 2"]}
             ]},
            {q: "3 friends share 1/2 cake. Each?", ans: "1/6", level: 5, points: 5, hint: "√∑ 3",
             methods: [
                 {title: "Method 1: Divide", steps: ["1/2 √∑ 3 = 1/6"]},
                 {title: "Method 2: Multiply", steps: ["1/2 √ó 1/3 = 1/6"]}
             ]},
            {q: "Convert 0.25 to fraction", ans: "1/4", level: 5, points: 5, hint: "25/100",
             methods: [
                 {title: "Method 1: Convert", steps: ["0.25 = 25/100 = 1/4"]},
                 {title: "Method 2: Know", steps: ["0.25 = 1/4"]}
             ]},
            {q: "1/5 of 20 is?", ans: "4", level: 5, points: 5, hint: "√∑ 5",
             methods: [
                 {title: "Method 1: Divide", steps: ["20 √∑ 5 = 4"]},
                 {title: "Method 2: Multiply", steps: ["1/5 √ó 20 = 4"]}
             ]},
            {q: "Add 0.6 and 2/5. Total?", ans: "1", level: 5, points: 5, hint: "Convert",
             methods: [
                 {title: "Method 1: Decimal", steps: ["2/5 = 0.4", "0.6 + 0.4 = 1"]},
                 {title: "Method 2: Fraction", steps: ["0.6 = 3/5", "3/5 + 2/5 = 1"]}
             ]}
        ];

        // Level 3: Long Word Problems (Chapter 1: Rational Numbers Only)
        const questionsLevel3 = [
    // Negative Numbers - Temperature (Q1-10)
    {
        q: "The temperature in Cameron Highlands was 15¬∞C in the morning. By afternoon, it dropped by 8¬∞C. What was the afternoon temperature? (Answer in ¬∞C)",
        ans: "7",
        level: 1,
        points: 6,
        hint: "Subtract the drop from morning temperature",
        methods: [
            {title: "Method 1: Subtraction", steps: [
                "Step 1: Morning temperature = 15¬∞C",
                "Step 2: Temperature drop = 8¬∞C",
                "Step 3: Afternoon temperature = 15 - 8 = 7¬∞C",
                "Answer: 7¬∞C"
            ]},
            {title: "Method 2: Using negative", steps: [
                "Temperature change = -8¬∞C",
                "New temperature = 15 + (-8) = 7¬∞C",
                "Answer: 7¬∞C"
            ]}
        ]
    },

    {
        q: "The temperature at midnight was -3¬∞C. By noon, it increased by 12¬∞C. What was the temperature at noon? (Answer in ¬∞C)",
        ans: "9",
        level: 1,
        points: 6,
        hint: "Add the increase to midnight temperature",
        methods: [
            {title: "Method 1: Addition", steps: [
                "Step 1: Midnight temperature = -3¬∞C",
                "Step 2: Temperature increase = 12¬∞C",
                "Step 3: Noon temperature = -3 + 12 = 9¬∞C",
                "Answer: 9¬∞C"
            ]},
            {title: "Method 2: Number line", steps: [
                "Start at -3",
                "Move 12 steps right (increase)",
                "Land on 9",
                "Answer: 9¬∞C"
            ]}
        ]
    },

    {
        q: "At 6am, the temperature was -5¬∞C. At 2pm, it was 8¬∞C. What was the temperature change? (Answer in ¬∞C)",
        ans: "13",
        level: 1,
        points: 6,
        hint: "Find difference between final and initial",
        methods: [
            {title: "Method 1: Subtraction", steps: [
                "Step 1: Final temperature = 8¬∞C",
                "Step 2: Initial temperature = -5¬∞C",
                "Step 3: Change = 8 - (-5) = 8 + 5 = 13¬∞C",
                "Answer: 13¬∞C"
            ]},
            {title: "Method 2: Count the change", steps: [
                "From -5 to 0 = 5¬∞C increase",
                "From 0 to 8 = 8¬∞C increase",
                "Total = 5 + 8 = 13¬∞C",
                "Answer: 13¬∞C"
            ]}
        ]
    },

    {
        q: "The temperature was 4¬∞C. It dropped 7¬∞C, then rose 5¬∞C. What is the final temperature? (Answer in ¬∞C)",
        ans: "2",
        level: 1,
        points: 6,
        hint: "Do operations in order: first drop, then rise",
        methods: [
            {title: "Method 1: Step by step", steps: [
                "Step 1: Start = 4¬∞C",
                "Step 2: After drop = 4 - 7 = -3¬∞C",
                "Step 3: After rise = -3 + 5 = 2¬∞C",
                "Answer: 2¬∞C"
            ]},
            {title: "Method 2: Combined", steps: [
                "Final = 4 - 7 + 5",
                "= -3 + 5 = 2¬∞C",
                "Answer: 2¬∞C"
            ]}
        ]
    },

    {
        q: "On Monday, the temperature was -2¬∞C. On Tuesday, it was 5¬∞C warmer than Monday. What was Tuesday's temperature? (Answer in ¬∞C)",
        ans: "3",
        level: 1,
        points: 6,
        hint: "Add 5 to Monday's temperature",
        methods: [
            {title: "Method 1: Addition", steps: [
                "Step 1: Monday = -2¬∞C",
                "Step 2: Tuesday = Monday + 5¬∞C",
                "Step 3: Tuesday = -2 + 5 = 3¬∞C",
                "Answer: 3¬∞C"
            ]},
            {title: "Method 2: Direct", steps: [
                "Tuesday = -2 + 5 = 3¬∞C",
                "Answer: 3¬∞C"
            ]}
        ]
    },

    {
        q: "A freezer temperature is -18¬∞C. If it warms up by 6¬∞C due to a power cut, what is the new temperature? (Answer in ¬∞C)",
        ans: "-12",
        level: 1,
        points: 6,
        hint: "Warming up means adding",
        methods: [
            {title: "Method 1: Addition", steps: [
                "Step 1: Initial = -18¬∞C",
                "Step 2: Warms up = +6¬∞C",
                "Step 3: New temperature = -18 + 6 = -12¬∞C",
                "Answer: -12¬∞C"
            ]},
            {title: "Method 2: Calculate", steps: [
                "-18 + 6 = -12",
                "Answer: -12¬∞C"
            ]}
        ]
    },

    {
        q: "The morning temperature was 3¬∞C. By evening, it became -4¬∞C. By how many degrees did it drop? (Answer in ¬∞C)",
        ans: "7",
        level: 1,
        points: 6,
        hint: "Find the difference",
        methods: [
            {title: "Method 1: Subtraction", steps: [
                "Step 1: Morning = 3¬∞C",
                "Step 2: Evening = -4¬∞C",
                "Step 3: Drop = 3 - (-4) = 3 + 4 = 7¬∞C",
                "Answer: 7¬∞C"
            ]},
            {title: "Method 2: Count", steps: [
                "From 3 to 0 = 3¬∞C down",
                "From 0 to -4 = 4¬∞C down",
                "Total drop = 3 + 4 = 7¬∞C",
                "Answer: 7¬∞C"
            ]}
        ]
    },

    {
        q: "A town's highest temperature today was 12¬∞C and lowest was -3¬∞C. What is the temperature difference? (Answer in ¬∞C)",
        ans: "15",
        level: 1,
        points: 6,
        hint: "Difference = highest - lowest",
        methods: [
            {title: "Method 1: Subtraction", steps: [
                "Step 1: Highest = 12¬∞C",
                "Step 2: Lowest = -3¬∞C",
                "Step 3: Difference = 12 - (-3) = 12 + 3 = 15¬∞C",
                "Answer: 15¬∞C"
            ]},
            {title: "Method 2: Distance between", steps: [
                "From -3 to 12 = 15¬∞C",
                "Answer: 15¬∞C"
            ]}
        ]
    },

    {
        q: "The temperature fell from 6¬∞C to -9¬∞C overnight. By how many degrees did it fall? (Answer in ¬∞C)",
        ans: "15",
        level: 1,
        points: 6,
        hint: "Calculate the total fall",
        methods: [
            {title: "Method 1: Subtraction", steps: [
                "Step 1: Initial = 6¬∞C",
                "Step 2: Final = -9¬∞C",
                "Step 3: Fall = 6 - (-9) = 6 + 9 = 15¬∞C",
                "Answer: 15¬∞C"
            ]},
            {title: "Method 2: Count the fall", steps: [
                "From 6 to 0 = 6¬∞C",
                "From 0 to -9 = 9¬∞C",
                "Total = 6 + 9 = 15¬∞C",
                "Answer: 15¬∞C"
            ]}
        ]
    },

    {
        q: "An air conditioner cools a room from 28¬∞C to 22¬∞C, then to 18¬∞C. What is the total temperature drop? (Answer in ¬∞C)",
        ans: "10",
        level: 1,
        points: 6,
        hint: "Find total change from start to end",
        methods: [
            {title: "Method 1: Find total drop", steps: [
                "Step 1: Initial = 28¬∞C",
                "Step 2: Final = 18¬∞C",
                "Step 3: Total drop = 28 - 18 = 10¬∞C",
                "Answer: 10¬∞C"
            ]},
            {title: "Method 2: Two stages", steps: [
                "First drop = 28 - 22 = 6¬∞C",
                "Second drop = 22 - 18 = 4¬∞C",
                "Total = 6 + 4 = 10¬∞C",
                "Answer: 10¬∞C"
            ]}
        ]
    },

    // Negative Numbers - Height/Depth (Q11-20)
    {
        q: "A submarine is at 50m below sea level. It descends another 30m. What is its new depth below sea level? (Answer as positive number in meters)",
        ans: "80",
        level: 2,
        points: 6,
        hint: "Below sea level = negative, descend = go down more",
        methods: [
            {title: "Method 1: Using negatives", steps: [
                "Step 1: Initial depth = -50m",
                "Step 2: Descend 30m = -30m",
                "Step 3: New depth = -50 + (-30) = -80m",
                "Step 4: 80m below sea level",
                "Answer: 80m"
            ]},
            {title: "Method 2: Add depths", steps: [
                "Total depth = 50 + 30 = 80m",
                "Answer: 80m below sea level"
            ]}
        ]
    },

    {
        q: "A diver is 35m below sea level. She swims up 15m. How many meters below sea level is she now? (Answer as positive number)",
        ans: "20",
        level: 2,
        points: 6,
        hint: "Swimming up = subtract from depth",
        methods: [
            {title: "Method 1: Subtraction", steps: [
                "Step 1: Initial depth = 35m below",
                "Step 2: Swims up = 15m",
                "Step 3: New depth = 35 - 15 = 20m below",
                "Answer: 20m"
            ]},
            {title: "Method 2: Using negatives", steps: [
                "Initial = -35m",
                "Swims up = +15m",
                "New = -35 + 15 = -20m (20m below)",
                "Answer: 20m"
            ]}
        ]
    },

    {
        q: "Mount Kinabalu peak is 4095m above sea level. The Dead Sea is 430m below sea level. What is the height difference? (Answer in meters)",
        ans: "4525",
        level: 2,
        points: 6,
        hint: "Add the distances from sea level",
        methods: [
            {title: "Method 1: Using negatives", steps: [
                "Step 1: Mount Kinabalu = +4095m",
                "Step 2: Dead Sea = -430m",
                "Step 3: Difference = 4095 - (-430) = 4095 + 430 = 4525m",
                "Answer: 4525m"
            ]},
            {title: "Method 2: Add both distances", steps: [
                "Distance = 4095 + 430 = 4525m",
                "Answer: 4525m"
            ]}
        ]
    },

    {
        q: "An airplane is flying at 8000m above sea level. A submarine is at 200m below sea level. What is the vertical distance between them? (Answer in meters)",
        ans: "8200",
        level: 2,
        points: 6,
        hint: "Add both distances from sea level",
        methods: [
            {title: "Method 1: Calculation", steps: [
                "Step 1: Airplane height = +8000m",
                "Step 2: Submarine depth = -200m",
                "Step 3: Distance = 8000 - (-200) = 8200m",
                "Answer: 8200m"
            ]},
            {title: "Method 2: Sum of distances", steps: [
                "Total = 8000 + 200 = 8200m",
                "Answer: 8200m"
            ]}
        ]
    },

    {
        q: "A building has 25 floors above ground and 3 basement levels. If ground level is 0, what is the difference between the top floor and lowest basement? (Answer in floors)",
        ans: "28",
        level: 2,
        points: 6,
        hint: "Top = +25, Lowest basement = -3",
        methods: [
            {title: "Method 1: Using floor numbers", steps: [
                "Step 1: Top floor = +25",
                "Step 2: Lowest basement = -3",
                "Step 3: Difference = 25 - (-3) = 28 floors",
                "Answer: 28 floors"
            ]},
            {title: "Method 2: Count", steps: [
                "Floors above ground = 25",
                "Basement levels = 3",
                "Total = 25 + 3 = 28",
                "Answer: 28 floors"
            ]}
        ]
    },

    {
        q: "A well is 15m deep below ground level. The ground is 2m above sea level. How far below sea level is the bottom of the well? (Answer in meters)",
        ans: "13",
        level: 2,
        points: 6,
        hint: "Ground is +2m, well bottom is -13m from sea level",
        methods: [
            {title: "Method 1: Step by step", steps: [
                "Step 1: Ground level = +2m above sea level",
                "Step 2: Well depth = 15m below ground",
                "Step 3: Well bottom = 2 - 15 = -13m",
                "Step 4: 13m below sea level",
                "Answer: 13m"
            ]},
            {title: "Method 2: Calculate", steps: [
                "Bottom = +2 - 15 = -13m",
                "Answer: 13m below sea level"
            ]}
        ]
    },

    {
        q: "A fish is swimming 8m below the water surface. It dives down 5m, then rises 3m. What is its final depth below the surface? (Answer in meters)",
        ans: "10",
        level: 2,
        points: 6,
        hint: "Start at -8, down -5, up +3",
        methods: [
            {title: "Method 1: Step by step", steps: [
                "Step 1: Initial = -8m",
                "Step 2: Dives 5m down = -8 - 5 = -13m",
                "Step 3: Rises 3m = -13 + 3 = -10m",
                "Step 4: 10m below surface",
                "Answer: 10m"
            ]},
            {title: "Method 2: Combined", steps: [
                "Final = -8 - 5 + 3 = -10m",
                "Answer: 10m below surface"
            ]}
        ]
    },

    {
        q: "A car park has levels from B3 (3 floors below ground) to L5 (5 floors above ground). How many levels are there in total?",
        ans: "8",
        level: 2,
        points: 6,
        hint: "Count from -3 to +5",
        methods: [
            {title: "Method 1: Using integers", steps: [
                "Step 1: Lowest = -3",
                "Step 2: Highest = +5",
                "Step 3: Difference = 5 - (-3) = 8 levels",
                "Answer: 8 levels"
            ]},
            {title: "Method 2: Count", steps: [
                "Basement levels = 3",
                "Above ground = 5",
                "Total = 3 + 5 = 8",
                "Answer: 8 levels"
            ]}
        ]
    },

    {
        q: "A lift starts at level 2. It goes down 5 floors, then up 8 floors. What level is it at now?",
        ans: "5",
        level: 2,
        points: 6,
        hint: "Start +2, down -5, up +8",
        methods: [
            {title: "Method 1: Step by step", steps: [
                "Step 1: Start = Level 2",
                "Step 2: Down 5 floors = 2 - 5 = -3",
                "Step 3: Up 8 floors = -3 + 8 = 5",
                "Answer: Level 5"
            ]},
            {title: "Method 2: Combined", steps: [
                "Final = 2 - 5 + 8 = 5",
                "Answer: Level 5"
            ]}
        ]
    },

    {
        q: "A cave entrance is 50m above sea level. The deepest chamber is 120m below the entrance. How far below sea level is the deepest chamber? (Answer in meters)",
        ans: "70",
        level: 2,
        points: 6,
        hint: "Entrance +50, chamber is 120 below entrance",
        methods: [
            {title: "Method 1: Calculate", steps: [
                "Step 1: Entrance = +50m above sea level",
                "Step 2: Chamber is 120m below entrance",
                "Step 3: Chamber level = 50 - 120 = -70m",
                "Step 4: 70m below sea level",
                "Answer: 70m"
            ]},
            {title: "Method 2: Difference", steps: [
                "Below sea level = 120 - 50 = 70m",
                "Answer: 70m"
            ]}
        ]
    },

    // Money - Bank Account/Profit/Loss (Q21-30)
    {
        q: "Ali's bank account had RM500. He withdrew RM250, then deposited RM180. What is his final balance? (Answer in RM)",
        ans: "430",
        level: 3,
        points: 6,
        hint: "Start 500, subtract 250, add 180",
        methods: [
            {title: "Method 1: Step by step", steps: [
                "Step 1: Initial = RM500",
                "Step 2: After withdrawal = 500 - 250 = RM250",
                "Step 3: After deposit = 250 + 180 = RM430",
                "Answer: RM430"
            ]},
            {title: "Method 2: Combined", steps: [
                "Final = 500 - 250 + 180 = 430",
                "Answer: RM430"
            ]}
        ]
    },

    {
        q: "Siti's bank account balance is RM320. She withdraws RM400. What is her new balance? (Answer in RM, use negative if needed)",
        ans: "-80",
        level: 3,
        points: 6,
        hint: "Overdraft = negative balance",
        methods: [
            {title: "Method 1: Subtraction", steps: [
                "Step 1: Initial = RM320",
                "Step 2: Withdrawal = RM400",
                "Step 3: New balance = 320 - 400 = -RM80",
                "Step 4: Overdraft of RM80",
                "Answer: -80"
            ]},
            {title: "Method 2: Calculate", steps: [
                "Balance = 320 - 400 = -80",
                "Answer: -RM80 (overdraft)"
            ]}
        ]
    },

    {
        q: "A trader bought goods for RM800 and sold them for RM650. What was his profit or loss? (Answer in RM, positive for profit, negative for loss)",
        ans: "-150",
        level: 3,
        points: 6,
        hint: "Profit/Loss = Selling Price - Cost Price",
        methods: [
            {title: "Method 1: Calculate", steps: [
                "Step 1: Cost Price = RM800",
                "Step 2: Selling Price = RM650",
                "Step 3: Profit/Loss = 650 - 800 = -RM150",
                "Step 4: Loss of RM150",
                "Answer: -150"
            ]},
            {title: "Method 2: Direct", steps: [
                "Loss = 650 - 800 = -150",
                "Answer: -150 (loss)"
            ]}
        ]
    },

    {
        q: "Encik Ahmad had RM1200 in his account. He wrote cheques for RM350 and RM480. Then he deposited RM600. What is his final balance? (Answer in RM)",
        ans: "970",
        level: 3,
        points: 6,
        hint: "Subtract both cheques, then add deposit",
        methods: [
            {title: "Method 1: Step by step", steps: [
                "Step 1: Initial = RM1200",
                "Step 2: After cheques = 1200 - 350 - 480 = RM370",
                "Step 3: After deposit = 370 + 600 = RM970",
                "Answer: RM970"
            ]},
            {title: "Method 2: Combined", steps: [
                "Final = 1200 - 350 - 480 + 600 = 970",
                "Answer: RM970"
            ]}
        ]
    },

    {
        q: "A business made a profit of RM3500 in January, a loss of RM1200 in February, and a profit of RM2800 in March. What was the total profit/loss? (Answer in RM)",
        ans: "5100",
        level: 3,
        points: 6,
        hint: "Profit = positive, Loss = negative",
        methods: [
            {title: "Method 1: Using signs", steps: [
                "Step 1: January = +RM3500",
                "Step 2: February = -RM1200",
                "Step 3: March = +RM2800",
                "Step 4: Total = 3500 + (-1200) + 2800 = RM5100",
                "Answer: RM5100 profit"
            ]},
            {title: "Method 2: Calculate", steps: [
                "Total = 3500 - 1200 + 2800 = 5100",
                "Answer: RM5100 profit"
            ]}
        ]
    },

    {
        q: "Rahman bought a laptop for RM2400 and sold it for RM2850. What was his profit? (Answer in RM)",
        ans: "450",
        level: 3,
        points: 6,
        hint: "Profit = Selling - Cost",
        methods: [
            {title: "Method 1: Subtraction", steps: [
                "Step 1: Cost = RM2400",
                "Step 2: Selling = RM2850",
                "Step 3: Profit = 2850 - 2400 = RM450",
                "Answer: RM450"
            ]},
            {title: "Method 2: Direct", steps: [
                "Profit = 2850 - 2400 = 450",
                "Answer: RM450"
            ]}
        ]
    },

    {
        q: "Lily's account had RM750. She paid RM320 for rent and RM180 for utilities. Her salary of RM2500 was then credited. What is her final balance? (Answer in RM)",
        ans: "2750",
        level: 3,
        points: 6,
        hint: "Subtract payments, add salary",
        methods: [
            {title: "Method 1: Step by step", steps: [
                "Step 1: Initial = RM750",
                "Step 2: After payments = 750 - 320 - 180 = RM250",
                "Step 3: After salary = 250 + 2500 = RM2750",
                "Answer: RM2750"
            ]},
            {title: "Method 2: Combined", steps: [
                "Final = 750 - 320 - 180 + 2500 = 2750",
                "Answer: RM2750"
            ]}
        ]
    },

    {
        q: "A shop made sales of RM8500 but had expenses of RM6200. What was the profit? (Answer in RM)",
        ans: "2300",
        level: 3,
        points: 6,
        hint: "Profit = Sales - Expenses",
        methods: [
            {title: "Method 1: Subtraction", steps: [
                "Step 1: Sales = RM8500",
                "Step 2: Expenses = RM6200",
                "Step 3: Profit = 8500 - 6200 = RM2300",
                "Answer: RM2300"
            ]},
            {title: "Method 2: Calculate", steps: [
                "Profit = 8500 - 6200 = 2300",
                "Answer: RM2300"
            ]}
        ]
    },

    {
        q: "Aziz had RM150. He spent RM85.50 on groceries and RM48.75 on petrol. How much does he have left? (Answer in RM)",
        ans: "15.75",
        level: 3,
        points: 6,
        hint: "Subtract both expenses",
        methods: [
            {title: "Method 1: Step by step", steps: [
                "Step 1: Initial = RM150",
                "Step 2: Total spent = 85.50 + 48.75 = RM134.25",
                "Step 3: Left = 150 - 134.25 = RM15.75",
                "Answer: RM15.75"
            ]},
            {title: "Method 2: Subtract each", steps: [
                "Left = 150 - 85.50 - 48.75 = 15.75",
                "Answer: RM15.75"
            ]}
        ]
    },

    {
        q: "A company earned RM45000 in Quarter 1 and RM38000 in Quarter 2, but made a loss of RM12000 in Quarter 3. What was the overall profit/loss? (Answer in RM)",
        ans: "71000",
        level: 3,
        points: 6,
        hint: "Add Q1 and Q2, subtract Q3 loss",
        methods: [
            {title: "Method 1: Using signs", steps: [
                "Step 1: Q1 = +RM45000",
                "Step 2: Q2 = +RM38000",
                "Step 3: Q3 = -RM12000",
                "Step 4: Total = 45000 + 38000 + (-12000) = RM71000",
                "Answer: RM71000 profit"
            ]},
            {title: "Method 2: Calculate", steps: [
                "Total = 45000 + 38000 - 12000 = 71000",
                "Answer: RM71000 profit"
            ]}
        ]
    },

    // Fractions - Sharing & Parts (Q31-40)
    {
        q: "Ali bought 3/4 kg of sugar and used 1/2 kg for baking. How much sugar is left? (Answer in kg as a fraction or decimal)",
        ans: "0.25",
        level: 4,
        points: 6,
        hint: "Convert to same denominator: 3/4 - 1/2",
        methods: [
            {title: "Method 1: Common denominator", steps: [
                "Step 1: 3/4 - 1/2",
                "Step 2: 1/2 = 2/4",
                "Step 3: 3/4 - 2/4 = 1/4 kg",
                "Step 4: 1/4 = 0.25 kg",
                "Answer: 0.25 kg"
            ]},
            {title: "Method 2: Decimal", steps: [
                "3/4 = 0.75 kg",
                "1/2 = 0.5 kg",
                "Left = 0.75 - 0.5 = 0.25 kg",
                "Answer: 0.25 kg"
            ]}
        ]
    },

    {
        q: "Siti had RM240. She spent 1/3 on books and 1/4 on food. How much did she spend in total? (Answer in RM)",
        ans: "140",
        level: 4,
        points: 6,
        hint: "Find 1/3 and 1/4 of 240, then add",
        methods: [
            {title: "Method 1: Calculate each", steps: [
                "Step 1: Books = 1/3 √ó 240 = RM80",
                "Step 2: Food = 1/4 √ó 240 = RM60",
                "Step 3: Total spent = 80 + 60 = RM140",
                "Answer: RM140"
            ]},
            {title: "Method 2: Add fractions first", steps: [
                "Total fraction = 1/3 + 1/4 = 4/12 + 3/12 = 7/12",
                "Spent = 7/12 √ó 240 = 140",
                "Answer: RM140"
            ]}
        ]
    },

    {
        q: "A rope is 5/6 meter long. If 2/3 meter is cut off, what length remains? (Answer in meters as decimal)",
        ans: "0.17",
        level: 4,
        points: 6,
        hint: "5/6 - 2/3, convert to same denominator",
        methods: [
            {title: "Method 1: Common denominator", steps: [
                "Step 1: 5/6 - 2/3",
                "Step 2: 2/3 = 4/6",
                "Step 3: 5/6 - 4/6 = 1/6 meter",
                "Step 4: 1/6 ‚âà 0.17 meter",
                "Answer: 0.17 meter"
            ]},
            {title: "Method 2: Decimal", steps: [
                "5/6 ‚âà 0.833 m",
                "2/3 ‚âà 0.667 m",
                "Remain = 0.833 - 0.667 ‚âà 0.17 m",
                "Answer: 0.17 m"
            ]}
        ]
    },

    {
        q: "Rahman had RM360. He gave 1/4 to his son and 1/6 to his daughter. How much money does he have left? (Answer in RM)",
        ans: "210",
        level: 4,
        points: 6,
        hint: "Find total given, then subtract from 360",
        methods: [
            {title: "Method 1: Calculate each", steps: [
                "Step 1: Son = 1/4 √ó 360 = RM90",
                "Step 2: Daughter = 1/6 √ó 360 = RM60",
                "Step 3: Total given = 90 + 60 = RM150",
                "Step 4: Left = 360 - 150 = RM210",
                "Answer: RM210"
            ]},
            {title: "Method 2: Fraction remaining", steps: [
                "Given = 1/4 + 1/6 = 3/12 + 2/12 = 5/12",
                "Remaining = 1 - 5/12 = 7/12",
                "Left = 7/12 √ó 360 = 210",
                "Answer: RM210"
            ]}
        ]
    },

    {
        q: "A bottle contains 1.5 liters of water. If 3/4 liter is poured out, how much water is left? (Answer in liters)",
        ans: "0.75",
        level: 4,
        points: 6,
        hint: "1.5 - 0.75 = ?",
        methods: [
            {title: "Method 1: Decimal subtraction", steps: [
                "Step 1: Initial = 1.5 liters",
                "Step 2: Poured = 3/4 = 0.75 liters",
                "Step 3: Left = 1.5 - 0.75 = 0.75 liters",
                "Answer: 0.75 liters"
            ]},
            {title: "Method 2: Fraction form", steps: [
                "1.5 = 3/2 liters",
                "Left = 3/2 - 3/4 = 6/4 - 3/4 = 3/4",
                "3/4 = 0.75",
                "Answer: 0.75 liters"
            ]}
        ]
    },

    {
        q: "Aminah baked a cake and ate 1/8 of it. Her brother ate 3/8 of it. What fraction of the cake is left? (Answer as decimal)",
        ans: "0.5",
        level: 4,
        points: 6,
        hint: "Total eaten = 1/8 + 3/8",
        methods: [
            {title: "Method 1: Add fractions", steps: [
                "Step 1: Total eaten = 1/8 + 3/8 = 4/8 = 1/2",
                "Step 2: Left = 1 - 1/2 = 1/2",
                "Step 3: 1/2 = 0.5",
                "Answer: 0.5"
            ]},
            {title: "Method 2: Calculate", steps: [
                "Eaten = 4/8 = 0.5",
                "Left = 1 - 0.5 = 0.5",
                "Answer: 0.5"
            ]}
        ]
    },

    {
        q: "A bag of rice weighs 5.5 kg. If 2.75 kg is used, how much rice is left? (Answer in kg)",
        ans: "2.75",
        level: 4,
        points: 6,
        hint: "Simple decimal subtraction",
        methods: [
            {title: "Method 1: Subtraction", steps: [
                "Step 1: Initial = 5.5 kg",
                "Step 2: Used = 2.75 kg",
                "Step 3: Left = 5.5 - 2.75 = 2.75 kg",
                "Answer: 2.75 kg"
            ]},
            {title: "Method 2: Direct", steps: [
                "Left = 5.5 - 2.75 = 2.75",
                "Answer: 2.75 kg"
            ]}
        ]
    },

    {
        q: "Encik Lim had RM450. He spent 2/5 on groceries and 1/3 of the remainder on petrol. How much money does he have left? (Answer in RM)",
        ans: "180",
        level: 4,
        points: 6,
        hint: "Find remainder after groceries first",
        methods: [
            {title: "Method 1: Step by step", steps: [
                "Step 1: Groceries = 2/5 √ó 450 = RM180",
                "Step 2: Remainder = 450 - 180 = RM270",
                "Step 3: Petrol = 1/3 √ó 270 = RM90",
                "Step 4: Left = 270 - 90 = RM180",
                "Answer: RM180"
            ]},
            {title: "Method 2: Fractions", steps: [
                "After groceries: 3/5 of 450 = 270",
                "After petrol: 2/3 of 270 = 180",
                "Answer: RM180"
            ]}
        ]
    },

    {
        q: "A pizza is divided into 8 equal slices. Ali ate 3 slices and Siti ate 2 slices. What fraction of the pizza is left? (Answer as decimal)",
        ans: "0.375",
        level: 4,
        points: 6,
        hint: "Eaten = 5 slices out of 8",
        methods: [
            {title: "Method 1: Fraction", steps: [
                "Step 1: Total eaten = 3 + 2 = 5 slices",
                "Step 2: Fraction eaten = 5/8",
                "Step 3: Left = 1 - 5/8 = 3/8",
                "Step 4: 3/8 = 0.375",
                "Answer: 0.375"
            ]},
            {title: "Method 2: Count slices", steps: [
                "Slices left = 8 - 5 = 3",
                "Fraction = 3/8 = 0.375",
                "Answer: 0.375"
            ]}
        ]
    },

    {
        q: "A tank had 12.5 liters of oil. After using 7.8 liters and adding 3.5 liters, how much oil is in the tank? (Answer in liters)",
        ans: "8.2",
        level: 4,
        points: 6,
        hint: "Subtract used, then add new oil",
        methods: [
            {title: "Method 1: Step by step", steps: [
                "Step 1: Initial = 12.5 L",
                "Step 2: After using = 12.5 - 7.8 = 4.7 L",
                "Step 3: After adding = 4.7 + 3.5 = 8.2 L",
                "Answer: 8.2 L"
            ]},
            {title: "Method 2: Combined", steps: [
                "Final = 12.5 - 7.8 + 3.5 = 8.2",
                "Answer: 8.2 L"
            ]}
        ]
    },

    // Mixed Operations - Complex Real World (Q41-50)
    {
        q: "A shop had RM850 at opening. Sales were RM1250 but expenses were RM680. What is the closing amount? (Answer in RM)",
        ans: "1420",
        level: 5,
        points: 6,
        hint: "Opening + Sales - Expenses",
        methods: [
            {title: "Method 1: Step by step", steps: [
                "Step 1: Opening = RM850",
                "Step 2: After sales = 850 + 1250 = RM2100",
                "Step 3: After expenses = 2100 - 680 = RM1420",
                "Answer: RM1420"
            ]},
            {title: "Method 2: Combined", steps: [
                "Closing = 850 + 1250 - 680 = 1420",
                "Answer: RM1420"
            ]}
        ]
    },

    {
        q: "Siti had RM500. She bought 3 books at RM15.50 each and 2 pens at RM4.25 each. How much money does she have left? (Answer in RM)",
        ans: "446",
        level: 5,
        points: 6,
        hint: "Calculate total cost first",
        methods: [
            {title: "Method 1: Step by step", steps: [
                "Step 1: Books cost = 3 √ó 15.50 = RM46.50",
                "Step 2: Pens cost = 2 √ó 4.25 = RM8.50",
                "Step 3: Total cost = 46.50 + 8.50 = RM55.00",
                "Step 4: Left = 500 - 55 = RM445.00",
                "Answer: RM445"
            ]},
            {title: "Method 2: Combined", steps: [
                "Total cost = (3 √ó 15.50) + (2 √ó 4.25) = 46.50 + 8.50 = 55",
                "Left = 500 - 55 = 445",
                "Answer: RM445"
            ]}
        ]
    },

    {
        q: "A baker made 120 cupcakes. He sold 2/3 in the morning and 1/4 of the remainder in the afternoon. How many cupcakes are left?",
        ans: "30",
        level: 5,
        points: 6,
        hint: "Find remainder after morning first",
        methods: [
            {title: "Method 1: Step by step", steps: [
                "Step 1: Morning sales = 2/3 √ó 120 = 80 cupcakes",
                "Step 2: Remainder = 120 - 80 = 40 cupcakes",
                "Step 3: Afternoon sales = 1/4 √ó 40 = 10 cupcakes",
                "Step 4: Left = 40 - 10 = 30 cupcakes",
                "Answer: 30 cupcakes"
            ]},
            {title: "Method 2: Fractions", steps: [
                "After morning: 1/3 √ó 120 = 40",
                "After afternoon: 3/4 √ó 40 = 30",
                "Answer: 30 cupcakes"
            ]}
        ]
    },

    {
        q: "Ali had RM800. He spent 1/4 on a phone, then spent RM125 on accessories. How much does he have left? (Answer in RM)",
        ans: "475",
        level: 5,
        points: 6,
        hint: "Find 1/4 of 800 first, then subtract both",
        methods: [
            {title: "Method 1: Step by step", steps: [
                "Step 1: Phone cost = 1/4 √ó 800 = RM200",
                "Step 2: Total spent = 200 + 125 = RM325",
                "Step 3: Left = 800 - 325 = RM475",
                "Answer: RM475"
            ]},
            {title: "Method 2: Calculate each", steps: [
                "After phone: 800 - 200 = 600",
                "After accessories: 600 - 125 = 475",
                "Answer: RM475"
            ]}
        ]
    },

    {
        q: "A water tank had 150 liters. In the morning, 45.5 liters was used. In the afternoon, 38.75 liters was used. How much water is left? (Answer in liters)",
        ans: "65.75",
        level: 5,
        points: 6,
        hint: "Add both amounts used, then subtract",
        methods: [
            {title: "Method 1: Total used first", steps: [
                "Step 1: Total used = 45.5 + 38.75 = 84.25 L",
                "Step 2: Left = 150 - 84.25 = 65.75 L",
                "Answer: 65.75 L"
            ]},
            {title: "Method 2: Subtract each", steps: [
                "After morning: 150 - 45.5 = 104.5",
                "After afternoon: 104.5 - 38.75 = 65.75",
                "Answer: 65.75 L"
            ]}
        ]
    },

    {
        q: "Rahman bought fruits: 2.5 kg of apples at RM4.80/kg, 1.8 kg of oranges at RM3.50/kg, and 3 kg of bananas at RM2.40/kg. What was his total bill? (Answer in RM)",
        ans: "25.50",
        level: 5,
        points: 6,
        hint: "Calculate cost of each fruit, then add",
        methods: [
            {title: "Method 1: Each fruit", steps: [
                "Step 1: Apples = 2.5 √ó 4.80 = RM12.00",
                "Step 2: Oranges = 1.8 √ó 3.50 = RM6.30",
                "Step 3: Bananas = 3 √ó 2.40 = RM7.20",
                "Step 4: Total = 12 + 6.30 + 7.20 = RM25.50",
                "Answer: RM25.50"
            ]},
            {title: "Method 2: Combined", steps: [
                "Total = (2.5√ó4.80) + (1.8√ó3.50) + (3√ó2.40)",
                "= 12 + 6.30 + 7.20 = 25.50",
                "Answer: RM25.50"
            ]}
        ]
    },

    {
        q: "A class collected RM960 for charity. 3/8 was donated to orphanage A, 1/3 to orphanage B, and the rest to orphanage C. How much did orphanage C receive? (Answer in RM)",
        ans: "280",
        level: 5,
        points: 6,
        hint: "Find total donated to A and B first",
        methods: [
            {title: "Method 1: Calculate A and B", steps: [
                "Step 1: A = 3/8 √ó 960 = RM360",
                "Step 2: B = 1/3 √ó 960 = RM320",
                "Step 3: Total A+B = 360 + 320 = RM680",
                "Step 4: C = 960 - 680 = RM280",
                "Answer: RM280"
            ]},
            {title: "Method 2: Fraction for C", steps: [
                "A and B = 3/8 + 1/3 = 9/24 + 8/24 = 17/24",
                "C = 1 - 17/24 = 7/24",
                "C = 7/24 √ó 960 = 280",
                "Answer: RM280"
            ]}
        ]
    },

    {
        q: "Puan Lim's monthly salary is RM3600. She saves 1/4, spends 2/5 on household expenses, and the rest on personal needs. How much does she spend on personal needs? (Answer in RM)",
        ans: "1260",
        level: 5,
        points: 6,
        hint: "Find savings and household first",
        methods: [
            {title: "Method 1: Calculate each", steps: [
                "Step 1: Savings = 1/4 √ó 3600 = RM900",
                "Step 2: Household = 2/5 √ó 3600 = RM1440",
                "Step 3: Total used = 900 + 1440 = RM2340",
                "Step 4: Personal = 3600 - 2340 = RM1260",
                "Answer: RM1260"
            ]},
            {title: "Method 2: Fraction for personal", steps: [
                "Used = 1/4 + 2/5 = 5/20 + 8/20 = 13/20",
                "Personal = 1 - 13/20 = 7/20",
                "Personal = 7/20 √ó 3600 = 1260",
                "Answer: RM1260"
            ]}
        ]
    },

    {
        q: "A shopkeeper bought 50 items at RM12.50 each. He sold 30 items at RM18.00 each and 20 items at RM15.00 each. What was his total profit? (Answer in RM)",
        ans: "265",
        level: 5,
        points: 6,
        hint: "Total cost vs total selling price",
        methods: [
            {title: "Method 1: Find profit", steps: [
                "Step 1: Total cost = 50 √ó 12.50 = RM625",
                "Step 2: Sales from 30 items = 30 √ó 18 = RM540",
                "Step 3: Sales from 20 items = 20 √ó 15 = RM300",
                "Step 4: Total sales = 540 + 300 = RM840",
                "Step 5: Profit = 840 - 625 = RM215",
                "Answer: RM215"
            ]},
            {title: "Method 2: Combined", steps: [
                "Cost = 50 √ó 12.50 = 625",
                "Sales = (30 √ó 18) + (20 √ó 15) = 540 + 300 = 840",
                "Profit = 840 - 625 = 215",
                "Answer: RM215"
            ]}
        ]
    },

    {
        q: "Ahmad's bank account had RM1500. He withdrew RM350 on Monday, deposited RM800 on Wednesday, and withdrew RM275 on Friday. What is his final balance? (Answer in RM)",
        ans: "1675",
        level: 5,
        points: 6,
        hint: "Follow the transactions in order",
        methods: [
            {title: "Method 1: Step by step", steps: [
                "Step 1: Initial = RM1500",
                "Step 2: After Monday = 1500 - 350 = RM1150",
                "Step 3: After Wednesday = 1150 + 800 = RM1950",
                "Step 4: After Friday = 1950 - 275 = RM1675",
                "Answer: RM1675"
            ]},
            {title: "Method 2: Combined", steps: [
                "Final = 1500 - 350 + 800 - 275",
                "= 1675",
                "Answer: RM1675"
            ]}
        ]
    }
        ];

        const questionsLevel1 = questions;

        const levelInfo = {
            1: {title: "‚≠ê Level 1: Integer Addition", desc: "Add positive and negative integers | +5 correct, -3 wrong, -6 timeout"},
            2: {title: "‚≠ê‚≠ê Level 2: Integer Subtraction", desc: "Subtract with negative numbers | +5 correct, -3 wrong, -6 timeout"},
            3: {title: "‚≠ê‚≠ê‚≠ê Level 3: Integer Multiplication", desc: "Multiply integers | +5 correct, -3 wrong, -6 timeout"},
            4: {title: "‚≠ê‚≠ê‚≠ê‚≠ê Level 4: Integer Division", desc: "Divide integers | +5 correct, -3 wrong, -6 timeout"},
            5: {title: "‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Level 5: Mixed Operations", desc: "BODMAS with integers | +5 correct, -3 wrong, -6 timeout"}
        };

        // Level System Variables
        let currentGameLevel = 1; // 1, 2, or 3
        let currentQuestion = 0;
        let score = 0;
        let correctCount = 0;
        let shuffledQuestions = [];
        let selectedStudent = "";
        let gameStartTime = 0;
        let answerResults = []; // Track each answer: 'correct', 'wrong', 'timeout'

        // Initialize student dropdown and level system
        window.addEventListener('DOMContentLoaded', function() {
            const select = document.getElementById('studentSelect');
            studentNames.forEach(name => {
                const option = document.createElement('option');
                option.value = name;
                option.textContent = name;
                select.appendChild(option);
            });
            
            // Update level screen when student changes
            select.addEventListener('change', function() {
                updateLevelSelectScreen();
            });
            
            // Load level progress
            updateLevelSelectScreen();
            
            // ÁªëÂÆöÊ∏ÖÈô§ÊåâÈíÆ Bind clear button
            const clearBtn = document.getElementById('clearLeaderboardBtn');
            if (clearBtn) {
                clearBtn.addEventListener('click', clearLeaderboard);
            }
            
            // ÁªëÂÆöliveÊ∏ÖÈô§ÊåâÈíÆ Bind live clear button
            const clearBtnLive = document.getElementById('clearLeaderboardBtnLive');
            if (clearBtnLive) {
                clearBtnLive.addEventListener('click', clearLeaderboard);
            }
        });

        // ========== LEVEL SYSTEM FUNCTIONS ==========
        
        function updateLevelSelectScreen() {
            const select = document.getElementById('studentSelect');
            const studentName = select.value;
            
            if (!studentName) {
                // No student selected - show locked state
                document.getElementById('level1BestScore').innerHTML = '';
                document.getElementById('level1Status').innerHTML = '‚úÖ Always Available';
                document.getElementById('level2Lock').style.display = 'flex';
                document.getElementById('level2BestScore').innerHTML = '';
                document.getElementById('level2Status').innerHTML = '';
                document.getElementById('level3Lock').style.display = 'flex';
                document.getElementById('level3BestScore').innerHTML = '';
                document.getElementById('level3Status').innerHTML = '';
                return;
            }
            
            const level1Data = getLevelProgress(1, studentName);
            const level2Data = getLevelProgress(2, studentName);
            const level3Data = getLevelProgress(3, studentName);
            
            // Update Level 1 status
            const level1BestScore = document.getElementById('level1BestScore');
            if (level1Data.bestScore !== null) {
                level1BestScore.innerHTML = `üèÜ Best: ${level1Data.bestScore}/100`;
                if (level1Data.passed) {
                    document.getElementById('level1Status').innerHTML = '‚úÖ Passed!';
                } else {
                    document.getElementById('level1Status').innerHTML = 'üéØ Not passed yet';
                }
            } else {
                level1BestScore.innerHTML = '';
                document.getElementById('level1Status').innerHTML = 'üÜï Not played yet';
            }
            
            // Update Level 2 status
            const level2Lock = document.getElementById('level2Lock');
            const level2Status = document.getElementById('level2Status');
            const level2BestScore = document.getElementById('level2BestScore');
            
            if (level1Data.passed) {
                // Level 2 unlocked for this student
                level2Lock.style.display = 'none';
                
                if (level2Data.bestScore !== null) {
                    level2BestScore.innerHTML = `üèÜ Best: ${level2Data.bestScore}/100`;
                    if (level2Data.passed) {
                        level2Status.innerHTML = '‚úÖ Passed!';
                    } else {
                        level2Status.innerHTML = 'üéØ Not passed yet';
                    }
                } else {
                    level2BestScore.innerHTML = '';
                    level2Status.innerHTML = 'üÜï Not played yet';
                }
            } else {
                // Level 2 locked for this student
                level2Lock.style.display = 'flex';
                level2BestScore.innerHTML = '';
                level2Status.innerHTML = '';
            }
            
            // Update Level 3 status
            const level3Lock = document.getElementById('level3Lock');
            const level3Status = document.getElementById('level3Status');
            const level3BestScore = document.getElementById('level3BestScore');
            
            if (level2Data.passed) {
                // Level 3 unlocked for this student
                level3Lock.style.display = 'none';
                
                if (level3Data.bestScore !== null) {
                    level3BestScore.innerHTML = `üèÜ Best: ${level3Data.bestScore}/100`;
                    if (level3Data.passed) {
                        level3Status.innerHTML = '‚úÖ Passed!';
                    } else {
                        level3Status.innerHTML = 'üéØ Not passed yet';
                    }
                } else {
                    level3BestScore.innerHTML = '';
                    level3Status.innerHTML = 'üÜï Not played yet';
                }
            } else {
                // Level 3 locked for this student
                level3Lock.style.display = 'flex';
                level3BestScore.innerHTML = '';
                level3Status.innerHTML = '';
            }
        }

        function getLevelProgress(levelNum, studentName) {
            if (!studentName) studentName = selectedStudent;
            if (!studentName) return { bestScore: null, passed: false };
            
            const key = `${studentName}_level${levelNum}`;
            const data = localStorage.getItem(key);
            
            if (!data) {
                return { bestScore: null, passed: false };
            }
            
            const parsed = JSON.parse(data);
            return {
                bestScore: parsed.bestScore || null,
                passed: parsed.passed || false
            };
        }

        function saveLevelProgress(levelNum, studentName, scoreOutOf100, passed) {
            const key = `${studentName}_level${levelNum}`;
            const existing = getLevelProgress(levelNum, studentName);
            
            const data = {
                bestScore: Math.max(existing.bestScore || 0, scoreOutOf100),
                passed: existing.passed || passed,
                lastPlayed: new Date().toISOString()
            };
            
            localStorage.setItem(key, JSON.stringify(data));
        }

        function selectLevel(levelNum) {
            const select = document.getElementById('studentSelect');
            if (!select.value) {
                alert('Please select your name first!');
                return;
            }
            
            const studentName = select.value;
            
            // Check if level is unlocked FOR THIS STUDENT
            if (levelNum === 2) {
                const level1Data = getLevelProgress(1, studentName);
                if (!level1Data.passed) {
                    alert(`üîí Level 2 is locked for ${studentName}!\n\nYou need to pass Level 1 first (40/50 correct).`);
                    return;
                }
            }
            
            if (levelNum === 3) {
                const level2Data = getLevelProgress(2, studentName);
                if (!level2Data.passed) {
                    alert(`üîí Level 3 is locked for ${studentName}!\n\nYou need to pass Level 2 first (40/50 correct).`);
                    return;
                }
            }
            
            currentGameLevel = levelNum;
            selectedStudent = studentName;
            
            // Update start screen info
            if (levelNum === 1) {
                document.getElementById('startLevelIcon').textContent = '‚≠ê';
                document.getElementById('startLevelTitle').textContent = 'Level 1: Basic';
                document.getElementById('startLevelSubtitle').textContent = 'Integer Operations';
                document.getElementById('startQuestionTypes').textContent = 'Integers: +, -, √ó, √∑, BODMAS';
                document.getElementById('startTimeInfo').textContent = '25-45 seconds per question';
            } else if (levelNum === 2) {
                document.getElementById('startLevelIcon').textContent = '‚≠ê‚≠ê';
                document.getElementById('startLevelTitle').textContent = 'Level 2: Advanced';
                document.getElementById('startLevelSubtitle').textContent = 'Fractions, Decimals & Mixed';
                document.getElementById('startQuestionTypes').textContent = 'Fractions, Decimals, Mixed Operations';
                document.getElementById('startTimeInfo').textContent = '20-35 seconds per question';
            } else if (levelNum === 3) {
                document.getElementById('startLevelIcon').textContent = '‚≠ê‚≠ê‚≠ê';
                document.getElementById('startLevelTitle').textContent = 'Level 3: Master';
                document.getElementById('startLevelSubtitle').textContent = 'Long Word Problems (Chapter 1)';
                document.getElementById('startQuestionTypes').textContent = 'Temperature, Height, Money, Real-World Applications';
                document.getElementById('startTimeInfo').textContent = '40-60 seconds per question';
            }
            
            // Show start screen
            document.getElementById('levelSelectScreen').style.display = 'none';
            document.getElementById('startScreen').style.display = 'block';
        }

        function backToLevelSelect() {
            stopTimer();
            stopSpeaking();
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameArea').style.display = 'none';
            document.getElementById('celebrationArea').style.display = 'none';
            document.getElementById('graduationScreen').style.display = 'none';
            document.getElementById('leaderboardScreen').style.display = 'none';
            document.getElementById('confirmBackScreen').style.display = 'none';
            document.getElementById('levelSelectScreen').style.display = 'block';
            updateLevelSelectScreen();
        }

        // ========== LIVE LEADERBOARD ==========

        function updateLiveLeaderboard() {
            const leaderboard = getLeaderboard();
            const content = document.getElementById('liveLeaderboardContent');
            
            if (leaderboard.length === 0) {
                content.innerHTML = '<div style="text-align: center; padding: 20px; opacity: 0.7;">No scores yet!</div>';
                return;
            }
            
            // Show top 10
            const topTen = leaderboard.slice(0, 10);
            let html = '';
            
            topTen.forEach((entry, index) => {
                const rank = index + 1;
                let rankEmoji = rank;
                let className = 'mini-leaderboard-item';
                
                if (rank === 1) {
                    rankEmoji = 'ü•á';
                    className += ' top1';
                } else if (rank === 2) {
                    rankEmoji = 'ü•à';
                    className += ' top2';
                } else if (rank === 3) {
                    rankEmoji = 'ü•â';
                    className += ' top3';
                }
                
                // Highlight current player
                if (entry.name === selectedStudent) {
                    className += ' current-player';
                }
                
                html += `
                    <div class="${className}">
                        <div class="mini-rank">${rankEmoji}</div>
                        <div class="mini-name">${entry.name}</div>
                        <div class="mini-score">${entry.score}</div>
                    </div>
                `;
            });
            
            content.innerHTML = html;
        }

        function updateAnswerMarkers() {
            const container = document.getElementById('answerMarkers');
            let html = '';
            
            // Show all 50 question markers
            for (let i = 0; i < 50; i++) {
                const num = i + 1;
                let className = 'answer-marker pending';
                let display = num;
                
                if (i < answerResults.length) {
                    const result = answerResults[i];
                    if (result === 'correct') {
                        className = 'answer-marker correct';
                        display = '‚úì';
                    } else if (result === 'wrong') {
                        className = 'answer-marker wrong';
                        display = '‚úó';
                    } else if (result === 'timeout') {
                        className = 'answer-marker timeout';
                        display = '‚è∞';
                    }
                }
                
                html += `<div class="${className}" title="Question ${num}">${display}</div>`;
            }
            
            container.innerHTML = html;
        }

        // Shuffle array function
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function startGame() {
            selectedStudent = document.getElementById('studentSelect').value;
            if (!selectedStudent) {
                alert('Please select your name first!');
                return;
            }

            // Select questions based on current game level
            let questionsToUse;
            if (currentGameLevel === 1) {
                questionsToUse = questionsLevel1;
            } else if (currentGameLevel === 2) {
                questionsToUse = questionsLevel2;
            } else if (currentGameLevel === 3) {
                questionsToUse = questionsLevel3;
            }
            
            shuffledQuestions = shuffleArray(questionsToUse);
            
            currentQuestion = 0;
            score = 0;
            correctCount = 0;
            totalTimeTaken = 0;
            gameStartTime = Date.now();
            answerResults = [];
            
            document.getElementById('score').textContent = '0';
            document.getElementById('correct').textContent = '0';
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameArea').style.display = 'block';
            document.getElementById('celebrationArea').style.display = 'none';
            document.getElementById('leaderboardScreen').style.display = 'none';
            
            updateLiveLeaderboard();
            updateAnswerMarkers();
            displayQuestion();
        }

        function restartToMenu() {
            // ÊòæÁ§∫Á°ÆËÆ§ÁïåÈù¢
            document.getElementById('gameArea').style.display = 'none';
            document.getElementById('confirmBackScreen').style.display = 'block';
        }

        function confirmBackToMenu() {
            // Á°ÆËÆ§ËøîÂõûËèúÂçï
            stopTimer();
            stopSpeaking();
            document.getElementById('confirmBackScreen').style.display = 'none';
            backToLevelSelect();
        }

        function cancelBackToMenu() {
            // ÂèñÊ∂àÔºåÁªßÁª≠Ê∏∏Êàè
            document.getElementById('confirmBackScreen').style.display = 'none';
            document.getElementById('gameArea').style.display = 'block';
        }

        function startTimer(seconds) {
            stopTimer();
            timeLeft = seconds;
            document.getElementById('timer').textContent = timeLeft;
            document.getElementById('timer').className = 'stat-value';
            
            questionTimer = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').textContent = timeLeft;
                
                if (timeLeft <= 5) {
                    document.getElementById('timer').className = 'stat-value danger';
                } else if (timeLeft <= 10) {
                    document.getElementById('timer').className = 'stat-value warning';
                }
                
                if (timeLeft <= 0) {
                    stopTimer();
                    timeOut();
                }
            }, 1000);
        }

        function stopTimer() {
            if (questionTimer) {
                clearInterval(questionTimer);
                questionTimer = null;
            }
        }

        function timeOut() {
            const answerInput = document.getElementById('answerInput');
            const submitBtn = document.getElementById('submitBtn');
            const nextBtn = document.getElementById('nextBtn');
            const feedback = document.getElementById('feedback');
            
            answerInput.disabled = true;
            submitBtn.style.display = 'none';
            nextBtn.style.display = 'inline-block';
            
            // TIMEOUT: -6 points
            const emoji1 = getRandomTimeoutEmoji();
            const emoji2 = getRandomTimeoutEmoji();
            
            playTimeoutSound();
            
            answerResults.push('timeout'); // Track result
            
            score -= 6;
            if (score < 0) score = 0; // Don't go below 0
            
            feedback.className = 'feedback wrong';
            feedback.innerHTML = `
                <div style="font-size: 2em; margin: 10px 0;">${emoji1} ${emoji2}</div>
                <div style="font-size: 1.5em; font-weight: bold;">‚è∞ TIME'S UP!</div>
                <div style="margin: 10px 0;">Correct answer: <strong>${shuffledQuestions[currentQuestion].ans}</strong></div>
                <div style="font-size: 1.3em; color: #dc3545; font-weight: bold;">-6 Points ‚åõ</div>
                <div style="margin-top: 10px; color: #28a745;">‚ö° Be faster next time! Study the solution below! üìö</div>
            `;
            
            document.getElementById('score').textContent = score;
            updateAnswerMarkers(); // Update visual tracker
            
            // Still show solution
            showSolutionSteps();
        }

        function displayQuestion() {
            stopSpeaking();
            stopTimer();
            
            if (currentQuestion >= shuffledQuestions.length) {
                showCelebration();
                return;
            }

            const q = shuffledQuestions[currentQuestion];
            const answerInput = document.getElementById('answerInput');
            const submitBtn = document.getElementById('submitBtn');
            const nextBtn = document.getElementById('nextBtn');
            const solutionBox = document.getElementById('solutionBox');

            // Display question with proper formatting
            document.getElementById('questionText').textContent = q.q + " = ?";
            document.getElementById('questionLabel').textContent = `Question ${currentQuestion + 1}`;
            document.getElementById('questionNum').textContent = `${currentQuestion + 1}/50`;
            document.getElementById('currentLevel').textContent = q.level;
            document.getElementById('levelTitle').textContent = levelInfo[q.level].title;
            document.getElementById('levelDesc').textContent = levelInfo[q.level].desc;
            
            answerInput.value = '';
            answerInput.disabled = false;
            submitBtn.style.display = 'inline-block';
            nextBtn.style.display = 'none';
            
            document.getElementById('feedback').style.display = 'none';
            document.getElementById('hintBox').classList.remove('show');
            solutionBox.classList.remove('show');
            answerInput.focus();

            const progress = ((currentQuestion + 1) / shuffledQuestions.length * 100).toFixed(0);
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressFill').textContent = progress + '%';

            // Start timer - 25 seconds for Level 1-2, 45 seconds for Level 3-5
            const timeLimit = (q.level <= 2) ? 25 : 45;
            startTimer(timeLimit);
        }

        function showSolutionSteps() {
            const solutionBox = document.getElementById('solutionBox');
            const solutionMethods = document.getElementById('solutionMethods');
            const methods = shuffledQuestions[currentQuestion].methods;
            
            let methodsHTML = '';
            methods.forEach((method, methodIndex) => {
                let stepsHTML = '';
                method.steps.forEach((step, stepIndex) => {
                    stepsHTML += `<div class="solution-step" data-method="${methodIndex}" data-step="${stepIndex}">${step}</div>`;
                });
                methodsHTML += `
                    <div class="method" data-method="${methodIndex}">
                        <div class="method-title">${method.title}</div>
                        <div class="solution-steps">${stepsHTML}</div>
                    </div>
                `;
            });
            
            solutionMethods.innerHTML = methodsHTML;
            solutionBox.classList.add('show');
        }

        function checkAnswer() {
            stopTimer();
            
            const userAnswer = document.getElementById('answerInput').value.trim();
            const correctAnswer = shuffledQuestions[currentQuestion].ans;
            const feedback = document.getElementById('feedback');
            const submitBtn = document.getElementById('submitBtn');
            const nextBtn = document.getElementById('nextBtn');
            const answerInput = document.getElementById('answerInput');

            if (userAnswer === '') {
                alert('Please enter an answer!');
                startTimer(timeLeft); // Resume timer
                return;
            }

            answerInput.disabled = true;
            submitBtn.style.display = 'none';
            nextBtn.style.display = 'inline-block';

            showSolutionSteps();

            if (userAnswer === correctAnswer) {
                // CORRECT: +5 points
                const emoji1 = getRandomCorrectEmoji();
                const emoji2 = getRandomCorrectEmoji();
                const emoji3 = getRandomCorrectEmoji();
                
                playCorrectSound();
                
                answerResults.push('correct'); // Track result
                
                feedback.className = 'feedback correct';
                feedback.innerHTML = `
                    <div style="font-size: 2em; margin: 10px 0;">${emoji1} ${emoji2} ${emoji3}</div>
                    <div style="font-size: 1.5em; font-weight: bold;">‚úì CORRECT! Well Done!</div>
                    <div style="margin: 10px 0;">Answer = ${correctAnswer}</div>
                    <div style="font-size: 1.3em; color: #28a745; font-weight: bold;">+5 Points! üéâ</div>
                    <div style="margin-top: 10px;">Click "üîä Read Solution" to hear the explanation!</div>
                `;
                
                score += 5;
                correctCount++;
                document.getElementById('score').textContent = score;
                document.getElementById('correct').textContent = correctCount;
                document.querySelector('.question-card').classList.add('bounce');
                
                updateAnswerMarkers(); // Update visual tracker
                
                setTimeout(() => {
                    document.querySelector('.question-card').classList.remove('bounce');
                }, 500);
            } else {
                // WRONG: -3 points
                const emoji1 = getRandomWrongEmoji();
                const emoji2 = getRandomWrongEmoji();
                
                playWrongSound();
                
                answerResults.push('wrong'); // Track result
                
                score -= 3;
                if (score < 0) score = 0; // Don't go below 0
                
                feedback.className = 'feedback wrong';
                feedback.innerHTML = `
                    <div style="font-size: 2em; margin: 10px 0;">${emoji1} ${emoji2}</div>
                    <div style="font-size: 1.5em; font-weight: bold;">‚úó Not Quite Right</div>
                    <div style="margin: 10px 0;">Your answer: <strong>${userAnswer}</strong></div>
                    <div style="margin: 10px 0;">Correct answer: <strong>${correctAnswer}</strong></div>
                    <div style="font-size: 1.3em; color: #dc3545; font-weight: bold;">-3 Points üìâ</div>
                    <div style="margin-top: 10px; color: #28a745;">üí™ Keep trying! Click "üîä Read Solution" to learn!</div>
                `;
                
                document.getElementById('score').textContent = score;
                updateAnswerMarkers(); // Update visual tracker
            }
        }

        function nextQuestion() {
            currentQuestion++;
            displayQuestion();
        }

        function showHint() {
            const hintBox = document.getElementById('hintBox');
            hintBox.textContent = 'üí° Hint: ' + shuffledQuestions[currentQuestion].hint;
            hintBox.classList.add('show');
        }

        function showCelebration() {
            stopTimer();
            
            const totalTime = Math.floor((Date.now() - gameStartTime) / 1000);
            const minutes = Math.floor(totalTime / 60);
            const seconds = totalTime % 60;
            const timeString = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            // Calculate score out of 100 for level progress
            const scoreOutOf100 = Math.round((score / 250) * 100);
            const passed = correctCount >= 40; // Need 40/50 correct to pass
            
            document.getElementById('gameArea').style.display = 'none';
            document.getElementById('celebrationArea').style.display = 'block';
            document.getElementById('studentNameDisplay').textContent = selectedStudent;
            document.getElementById('finalScore').textContent = `${score}/250 points (${scoreOutOf100}/100)`;
            document.getElementById('totalTimeDisplay').textContent = timeString;
            document.getElementById('celebrationTitle').textContent = `üéâ Level ${currentGameLevel} Complete! üéâ`;
            document.getElementById('celebrationMessage').innerHTML = `Correct Answers: <strong>${correctCount}/50</strong>`;
            
            let performance = '';
            if (score >= 225) performance = 'üèÜ PERFECT! You\'re a Math GENIUS! Â§©Êâç!';
            else if (score >= 200) performance = 'üåü EXCELLENT! Outstanding Performance! Â§™Ê£í‰∫Ü!';
            else if (score >= 150) performance = 'üëç GREAT JOB! Keep it up! Âä†Ê≤π!';
            else if (score >= 100) performance = 'üí™ GOOD EFFORT! Practice more! ÁªßÁª≠Âä™Âäõ!';
            else performance = 'üìö Keep Learning! You can do better! ‰∏çË¶ÅÊîæÂºÉ!';
            
            document.getElementById('performance').textContent = performance;
            
            // Show pass/fail status
            const passFailDiv = document.getElementById('passFailStatus');
            if (passed) {
                passFailDiv.style.background = 'linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%)';
                passFailDiv.style.color = '#155724';
                passFailDiv.style.border = '3px solid #28a745';
                
                if (currentGameLevel === 1) {
                    passFailDiv.innerHTML = `
                        <div style="font-size: 2em; margin-bottom: 10px;">‚úÖ</div>
                        <div style="font-size: 1.3em; font-weight: bold;">LEVEL 1 PASSED!</div>
                        <div style="margin-top: 10px;">You got ${correctCount}/50 correct!</div>
                        <div style="margin-top: 15px; font-size: 1.1em;">üéâ <strong>Level 2 Unlocked!</strong></div>
                    `;
                } else {
                    passFailDiv.innerHTML = `
                        <div style="font-size: 2em; margin-bottom: 10px;">‚úÖ</div>
                        <div style="font-size: 1.3em; font-weight: bold;">LEVEL 2 PASSED!</div>
                        <div style="margin-top: 10px;">You got ${correctCount}/50 correct!</div>
                        <div style="margin-top: 15px; font-size: 1.1em;">üèÜ <strong>Chapter 1 GRADUATED!</strong></div>
                    `;
                }
            } else {
                passFailDiv.style.background = 'linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%)';
                passFailDiv.style.color = '#721c24';
                passFailDiv.style.border = '3px solid #dc3545';
                passFailDiv.innerHTML = `
                    <div style="font-size: 2em; margin-bottom: 10px;">‚ùå</div>
                    <div style="font-size: 1.3em; font-weight: bold;">NOT PASSED YET</div>
                    <div style="margin-top: 10px;">You got ${correctCount}/50 correct</div>
                    <div style="margin-top: 10px;">Need: <strong>40/50 (80%)</strong> to pass</div>
                    <div style="margin-top: 15px;">üí™ Try again! You can do it!</div>
                `;
            }
            
            // Update level progress for this student
            saveLevelProgress(currentGameLevel, selectedStudent, scoreOutOf100, passed);
            
            if (passed) {
                // Check if ALL THREE levels passed for THIS STUDENT for graduation
                const level1Data = getLevelProgress(1, selectedStudent);
                const level2Data = getLevelProgress(2, selectedStudent);
                const level3Data = getLevelProgress(3, selectedStudent);
                
                if (level1Data.passed && level2Data.passed && level3Data.passed) {
                    // Show graduation after a delay
                    setTimeout(() => {
                        showGraduation();
                    }, 3000);
                }
            }
            
            // Save to leaderboard with level info
            const leaderboard = getLeaderboard();
            leaderboard.push({
                name: selectedStudent,
                score: score,
                level: currentGameLevel,
                correctCount: correctCount,
                time: totalTime,
                timeString: timeString,
                date: new Date().toISOString()
            });
            
            // Sort by score (desc), then by time (asc)
            leaderboard.sort((a, b) => {
                if (b.score !== a.score) return b.score - a.score;
                return a.time - b.time;
            });
            
            // Keep top 50 scores
            if (leaderboard.length > 50) {
                leaderboard.splice(50);
            }
            
            saveLeaderboard(leaderboard);
            updateLiveLeaderboard();
        }

        function showGraduation() {
            const level1Data = getLevelProgress(1, selectedStudent);
            const level2Data = getLevelProgress(2, selectedStudent);
            const level3Data = getLevelProgress(3, selectedStudent);
            const level1Score = level1Data.bestScore || 0;
            const level2Score = level2Data.bestScore || 0;
            const level3Score = level3Data.bestScore || 0;
            const totalScore = level1Score + level2Score + level3Score;
            
            document.getElementById('celebrationArea').style.display = 'none';
            document.getElementById('graduationScreen').style.display = 'block';
            
            document.getElementById('gradStudentName').textContent = selectedStudent;
            document.getElementById('gradLevel1Score').textContent = `${level1Score}/100`;
            document.getElementById('gradLevel2Score').textContent = `${level2Score}/100`;
            document.getElementById('gradLevel3Score').textContent = `${level3Score}/100`;
            document.getElementById('gradTotalScore').textContent = `${totalScore}/300`;
            document.getElementById('gradDate').textContent = new Date().toLocaleDateString('en-MY');
        }

        function showLeaderboard() {
            const leaderboard = getLeaderboard();
            
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameArea').style.display = 'none';
            document.getElementById('celebrationArea').style.display = 'none';
            document.getElementById('leaderboardScreen').style.display = 'block';
            
            const tableDiv = document.getElementById('leaderboardTable');
            
            if (leaderboard.length === 0) {
                tableDiv.innerHTML = '<div style="text-align: center; padding: 40px; font-size: 1.2em; color: white;">No scores yet. Be the first to play!</div>';
                return;
            }
            
            let html = '';
            leaderboard.forEach((entry, index) => {
                const rank = index + 1;
                let rankEmoji = rank + '.';
                let className = 'leaderboard-item';
                
                if (rank === 1) {
                    rankEmoji = 'ü•á';
                    className += ' top1';
                } else if (rank === 2) {
                    rankEmoji = 'ü•à';
                    className += ' top2';
                } else if (rank === 3) {
                    rankEmoji = 'ü•â';
                    className += ' top3';
                }
                
                let levelColor = '#667eea'; // Level 1 - purple
                if (entry.level === 2) levelColor = '#f5576c'; // Level 2 - pink
                if (entry.level === 3) levelColor = '#fee140'; // Level 3 - yellow
                const levelBadge = entry.level ? `<span style="background: ${levelColor}; padding: 3px 8px; border-radius: 5px; font-size: 0.8em; margin-left: 5px; color: ${entry.level === 3 ? '#333' : 'white'};">L${entry.level}</span>` : '';
                const correctInfo = entry.correctCount ? `<span style="font-size: 0.9em; opacity: 0.8;"> (${entry.correctCount}/50)</span>` : '';
                
                html += `
                    <div class="${className}">
                        <div class="leaderboard-rank">${rankEmoji}</div>
                        <div class="leaderboard-name">${entry.name}${levelBadge}</div>
                        <div class="leaderboard-score">${entry.score} pts${correctInfo}</div>
                        <div class="leaderboard-time">‚è±Ô∏è ${entry.timeString}</div>
                    </div>
                `;
            });
            
            tableDiv.innerHTML = html;
        }

        function backToMenu() {
            backToLevelSelect();
        }

        function showClearForm() {
            document.getElementById('leaderboardScreen').style.display = 'none';
            document.getElementById('clearPasswordScreen').style.display = 'block';
            document.getElementById('clearPassword').value = '';
            document.getElementById('clearMessage').style.display = 'none';
            document.getElementById('clearPassword').focus();
        }

        function cancelClear() {
            document.getElementById('clearPasswordScreen').style.display = 'none';
            document.getElementById('leaderboardScreen').style.display = 'block';
        }

        function checkPasswordAndClear() {
            var password = document.getElementById('clearPassword').value;
            var messageDiv = document.getElementById('clearMessage');
            
            if (password === 'ck355091GOH!') {
                // ÂØÜÁ†ÅÊ≠£Á°Æ - Ê∏ÖÈô§leaderboardÂíåÊâÄÊúâÂ≠¶ÁîüËøõÂ∫¶
                
                // Clear leaderboard
                localStorage.removeItem('rationalNumbersLeaderboard');
                
                // Clear ALL student progress data (3 levels)
                studentNames.forEach(studentName => {
                    localStorage.removeItem(`${studentName}_level1`);
                    localStorage.removeItem(`${studentName}_level2`);
                    localStorage.removeItem(`${studentName}_level3`);
                });
                
                // Also clear any old format data (backward compatibility)
                localStorage.removeItem('level1_best_score');
                localStorage.removeItem('level1_passed');
                localStorage.removeItem('level2_best_score');
                localStorage.removeItem('level2_passed');
                localStorage.removeItem('level3_best_score');
                localStorage.removeItem('level3_passed');
                localStorage.removeItem('chapter1_graduated');
                
                messageDiv.style.display = 'block';
                messageDiv.style.background = '#d4edda';
                messageDiv.style.color = '#155724';
                messageDiv.style.border = '2px solid #28a745';
                messageDiv.innerHTML = '‚úÖ <strong>Success!</strong> Leaderboard and all student progress (3 levels) cleared!';
                
                setTimeout(function() {
                    location.reload();
                }, 2000);
            } else {
                // ÂØÜÁ†ÅÈîôËØØ
                messageDiv.style.display = 'block';
                messageDiv.style.background = '#f8d7da';
                messageDiv.style.color = '#721c24';
                messageDiv.style.border = '2px solid #dc3545';
                messageDiv.innerHTML = '‚ùå <strong>Wrong Password!</strong> Access denied.';
                
                document.getElementById('clearPassword').value = '';
                document.getElementById('clearPassword').focus();
            }
        }

        // ÂÖÅËÆ∏ÊåâEnterÈîÆÊèê‰∫§
        document.addEventListener('DOMContentLoaded', function() {
            var passwordInput = document.getElementById('clearPassword');
            if (passwordInput) {
                passwordInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        checkPasswordAndClear();
                    }
                });
            }
        });

        function restartGame() {
            // Restart current level
            document.getElementById('celebrationArea').style.display = 'none';
            document.getElementById('graduationScreen').style.display = 'none';
            startGame();
        }

        document.getElementById('answerInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                checkAnswer();
            }
        });

        // Text-to-Speech Functions
        function speakSolution() {
            stopSpeaking();

            const playBtn = document.getElementById('playBtn');
            const stopBtn = document.getElementById('stopBtn');
            
            playBtn.style.display = 'none';
            stopBtn.style.display = 'inline-flex';
            isSpeaking = true;

            const methods = shuffledQuestions[currentQuestion].methods;

            allStepsData = [];
            allStepsData.push({ type: 'intro', text: 'Let me explain the solution.' });
            
            methods.forEach((method, methodIndex) => {
                allStepsData.push({ 
                    type: 'method-title',
                    text: method.title,
                    methodIndex: methodIndex
                });
                
                method.steps.forEach((step, stepIndex) => {
                    let cleanStep = step;
                    
                    // Handle negative numbers in parentheses: (-6) becomes "negative 6"
                    cleanStep = cleanStep.replace(/\((-?\d+)\)/g, function(match, num) {
                        if (num.startsWith('-')) {
                            return 'negative ' + num.substring(1);
                        }
                        return num;
                    });
                    
                    // Handle standalone negative numbers: -4 becomes "negative 4"
                    cleanStep = cleanStep.replace(/(?:^|[=\s])(-\d+)/g, function(match, num) {
                        return match.replace(num, 'negative ' + num.substring(1));
                    });
                    
                    // Handle positive numbers explicitly mentioned with +
                    cleanStep = cleanStep.replace(/\+(\d+)/g, 'positive $1');
                    
                    // Replace mathematical operators
                    cleanStep = cleanStep
                        .replace(/√ó/g, ' times ')
                        .replace(/√∑/g, ' divided by ')
                        .replace(/\+/g, ' plus ')
                        .replace(/\s*-\s*/g, ' minus ')
                        .replace(/=/g, ' equals ')
                        .replace(/>/g, ' is greater than ')
                        .replace(/</g, ' is less than ');
                    
                    // Clean up extra spaces
                    cleanStep = cleanStep.replace(/\s+/g, ' ').trim();
                    
                    allStepsData.push({
                        type: 'step',
                        text: cleanStep,
                        methodIndex: methodIndex,
                        stepIndex: stepIndex
                    });
                });
            });
            
            allStepsData.push({ type: 'outro', text: 'That completes the solution.' });

            currentStepIndex = 0;
            speakNextStep();
        }

        function speakNextStep() {
            if (!isSpeaking || currentStepIndex >= allStepsData.length) {
                if (currentStepIndex >= allStepsData.length) {
                    const playBtn = document.getElementById('playBtn');
                    const stopBtn = document.getElementById('stopBtn');
                    playBtn.style.display = 'inline-flex';
                    stopBtn.style.display = 'none';
                    isSpeaking = false;
                    
                    document.querySelectorAll('.solution-step.speaking').forEach(el => {
                        el.classList.remove('speaking');
                    });
                }
                return;
            }

            const stepData = allStepsData[currentStepIndex];
            
            if (stepData.type === 'method-title') {
                const methodDiv = document.querySelector(`.method[data-method="${stepData.methodIndex}"]`);
                if (methodDiv) methodDiv.classList.add('visible');
            }
            else if (stepData.type === 'step') {
                document.querySelectorAll('.solution-step.speaking').forEach(el => {
                    el.classList.remove('speaking');
                });
                
                const stepDiv = document.querySelector(`.solution-step[data-method="${stepData.methodIndex}"][data-step="${stepData.stepIndex}"]`);
                if (stepDiv) {
                    stepDiv.classList.add('visible');
                    stepDiv.classList.add('speaking');
                }
            }

            const utterance = new SpeechSynthesisUtterance(stepData.text);
            utterance.rate = speechSpeed;
            utterance.pitch = 1;
            utterance.volume = 1;

            const voices = speechSynthesis.getVoices();
            const englishVoice = voices.find(voice => voice.lang.includes('en'));
            if (englishVoice) utterance.voice = englishVoice;

            utterance.onend = function() {
                currentStepIndex++;
                speakNextStep();
            };

            utterance.onerror = function() {
                currentStepIndex++;
                speakNextStep();
            };

            speechSynthesis.speak(utterance);
        }

        function stopSpeaking() {
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
            isSpeaking = false;
            
            const playBtn = document.getElementById('playBtn');
            const stopBtn = document.getElementById('stopBtn');
            playBtn.style.display = 'inline-flex';
            stopBtn.style.display = 'none';
            
            document.querySelectorAll('.solution-step.speaking').forEach(el => {
                el.classList.remove('speaking');
            });
        }

        function changeSpeed() {
            const speedControl = document.getElementById('speedControl');
            speechSpeed = parseFloat(speedControl.value);
            
            if (isSpeaking) {
                stopSpeaking();
                setTimeout(() => speakSolution(), 100);
            }
        }

        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = function() {
                // Voices loaded
            };
        }
    </script>
</body>
</html>
